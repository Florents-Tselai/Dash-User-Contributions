<!DOCTYPE html>

<html class="no-js" data-content_root="./" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="light dark" name="color-scheme"/><meta content="width=device-width, initial-scale=1" name="viewport">
<link href="genindex.html" rel="index" title="Index"/><link href="search.html" rel="search" title="Search"/><link href="contributing.html" rel="prev" title="Contributing"/>
<!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
<script data-domain="sqlite-utils.datasette.io" defer="" src="https://plausible.io/js/plausible.js"></script>
<title>Changelog - sqlite-utils</title>
<link href="_static/pygments.css?v=fa44fd50" rel="stylesheet" type="text/css"/>
<link href="_static/styles/furo.css?v=135e06be" rel="stylesheet" type="text/css"/>
<link href="_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="_static/styles/furo-extensions.css?v=36a5483c" rel="stylesheet" type="text/css"/>
<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></meta></head>
<body>
<script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<symbol id="svg-toc" viewbox="0 0 24 24">
<title>Contents</title>
<svg fill="currentColor" stroke="currentColor" stroke-width="0" viewbox="0 0 1024 1024">
<path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"></path>
</svg>
</symbol>
<symbol id="svg-menu" viewbox="0 0 24 24">
<title>Menu</title>
<svg class="feather-menu" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<line x1="3" x2="21" y1="12" y2="12"></line>
<line x1="3" x2="21" y1="6" y2="6"></line>
<line x1="3" x2="21" y1="18" y2="18"></line>
</svg>
</symbol>
<symbol id="svg-arrow-right" viewbox="0 0 24 24">
<title>Expand</title>
<svg class="feather-chevron-right" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<polyline points="9 18 15 12 9 6"></polyline>
</svg>
</symbol>
<symbol id="svg-sun" viewbox="0 0 24 24">
<title>Light mode</title>
<svg class="feather-sun" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="5"></circle>
<line x1="12" x2="12" y1="1" y2="3"></line>
<line x1="12" x2="12" y1="21" y2="23"></line>
<line x1="4.22" x2="5.64" y1="4.22" y2="5.64"></line>
<line x1="18.36" x2="19.78" y1="18.36" y2="19.78"></line>
<line x1="1" x2="3" y1="12" y2="12"></line>
<line x1="21" x2="23" y1="12" y2="12"></line>
<line x1="4.22" x2="5.64" y1="19.78" y2="18.36"></line>
<line x1="18.36" x2="19.78" y1="5.64" y2="4.22"></line>
</svg>
</symbol>
<symbol id="svg-moon" viewbox="0 0 24 24">
<title>Dark mode</title>
<svg class="icon-tabler-moon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
</svg>
</symbol>
<symbol id="svg-sun-half" viewbox="0 0 24 24">
<title>Auto light/dark mode</title>
<svg class="icon-tabler-shadow" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<path d="M13 12h5"></path>
<path d="M13 15h4"></path>
<path d="M13 18h1"></path>
<path d="M13 9h4"></path>
<path d="M13 6h1"></path>
</svg>
</symbol>
</svg>
<input class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<input class="sidebar-toggle" id="__toc" name="__toc" type="checkbox"/>
<label class="overlay sidebar-overlay" for="__navigation">
<div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
<div class="visually-hidden">Hide table of contents sidebar</div>
</label>
<div class="page">
<header class="mobile-header">
<div class="header-left">
<label class="nav-overlay-icon" for="__navigation">
<div class="visually-hidden">Toggle site navigation sidebar</div>
<i class="icon"><svg><use href="#svg-menu"></use></svg></i>
</label>
</div>
<div class="header-center">
<a href="index.html"><div class="brand">sqlite-utils</div></a>
</div>
<div class="header-right">
<div class="theme-toggle-container theme-toggle-header">
<button class="theme-toggle">
<div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
<svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
<svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
<svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
</button>
</div>
<label class="toc-overlay-icon toc-header-icon" for="__toc">
<div class="visually-hidden">Toggle table of contents sidebar</div>
<i class="icon"><svg><use href="#svg-toc"></use></svg></i>
</label>
</div>
</header>
<aside class="sidebar-drawer">
<div class="sidebar-container">
<div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
<span class="sidebar-brand-text">sqlite-utils</span>
</a><form action="search.html" class="sidebar-search-container" method="get" role="search">
<input aria-label="Search" class="sidebar-search" name="q" placeholder="Search"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">sqlite-utils command-line tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="python-api.html">sqlite_utils Python library</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli-reference.html">CLI reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Changelog</a></li>
</ul>
</div>
</div>
</div>
</div>
</aside>
<div class="main">
<div class="content">
<div class="article-container">
<a class="back-to-top muted-link" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
</svg>
<span>Back to top</span>
</a>
<div class="content-icon-container">
<div class="theme-toggle-container theme-toggle-content">
<button class="theme-toggle">
<div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
<svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
<svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
<svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
</button>
</div>
<label class="toc-overlay-icon toc-content-icon" for="__toc">
<div class="visually-hidden">Toggle table of contents sidebar</div>
<i class="icon"><svg><use href="#svg-toc"></use></svg></i>
</label>
</div>
<article role="main">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Changelog"></a><section id="changelog">
<span id="id1"></span><h1>Changelog<a class="headerlink" href="#changelog" title="Link to this heading">#</a></h1>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.33 (2023-06-25)"></a><section id="v3-33">
<span id="id2"></span><h2>3.33 (2023-06-25)<a class="headerlink" href="#v3-33" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span></code> will now use <a class="reference external" href="https://github.com/nalgeon/sqlean.py">sqlean.py</a> in place of <code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> if it is installed in the same virtual environment. This is useful for Python environments with either an outdated version of SQLite or with restrictions on SQLite such as disabled extension loading or restrictions resulting in the <code class="docutils literal notranslate"><span class="pre">sqlite3.OperationalError:</span> <span class="pre">table</span> <span class="pre">sqlite_master</span> <span class="pre">may</span> <span class="pre">not</span> <span class="pre">be</span> <span class="pre">modified</span></code> error. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/559">#559</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">db.ensure_autocommit_off()</span></code> context manager, which ensures that the database is in autocommit mode for the duration of a block of code. This is used by <code class="docutils literal notranslate"><span class="pre">db.enable_wal()</span></code> and <code class="docutils literal notranslate"><span class="pre">db.disable_wal()</span></code> to ensure they work correctly with <code class="docutils literal notranslate"><span class="pre">pysqlite3</span></code> and <code class="docutils literal notranslate"><span class="pre">sqlean.py</span></code>.</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">db.iterdump()</span></code> method, providing an iterator over SQL strings representing a dump of the database. This uses <code class="docutils literal notranslate"><span class="pre">sqlite-dump</span></code> if it is available, otherwise falling back on the <code class="docutils literal notranslate"><span class="pre">conn.iterdump()</span></code> method from <code class="docutils literal notranslate"><span class="pre">sqlite3</span></code>. Both <code class="docutils literal notranslate"><span class="pre">pysqlite3</span></code> and <code class="docutils literal notranslate"><span class="pre">sqlean.py</span></code> omit support for <code class="docutils literal notranslate"><span class="pre">iterdump()</span></code> - this method helps paper over that difference.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.32.1 (2023-05-21)"></a><section id="v3-32-1">
<span id="id3"></span><h2>3.32.1 (2023-05-21)<a class="headerlink" href="#v3-32-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Examples in the <a class="reference internal" href="cli.html#cli"><span class="std std-ref">CLI documentation</span></a> can now all be copied and pasted without needing to remove a leading <code class="docutils literal notranslate"><span class="pre">$</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/551">#551</a>)</p></li>
<li><p>Documentation now covers <a class="reference internal" href="installation.html#installation-completion"><span class="std std-ref">Setting up shell completion</span></a> for <code class="docutils literal notranslate"><span class="pre">bash</span></code> and <code class="docutils literal notranslate"><span class="pre">zsh</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/552">#552</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.32 (2023-05-21)"></a><section id="v3-32">
<span id="id4"></span><h2>3.32 (2023-05-21)<a class="headerlink" href="#v3-32" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New experimental <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">tui</span></code> interface for interactively building command-line invocations, powered by <a class="reference external" href="https://github.com/Textualize/trogon">Trogon</a>. This requires an optional dependency, installed using <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">install</span> <span class="pre">trogon</span></code>. There is a screenshot <a class="reference internal" href="cli.html#cli-tui"><span class="std std-ref">in the documentation</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/545">#545</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">analyze-tables</span></code> command (<a class="reference internal" href="cli.html#cli-analyze-tables"><span class="std std-ref">documentation</span></a>) now has a <code class="docutils literal notranslate"><span class="pre">--common-limit</span> <span class="pre">20</span></code> option for changing the number of common/least-common values shown for each column. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/544">#544</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">analyze-tables</span> <span class="pre">--no-most</span></code> and <code class="docutils literal notranslate"><span class="pre">--no-least</span></code> options for disabling calculation of most-common and least-common values.</p></li>
<li><p>If a column contains only <code class="docutils literal notranslate"><span class="pre">null</span></code> values, <code class="docutils literal notranslate"><span class="pre">analyze-tables</span></code> will no longer attempt to calculate the most common and least common values for that column. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/547">#547</a>)</p></li>
<li><p>Calling <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">analyze-tables</span></code> with non-existent columns in the <code class="docutils literal notranslate"><span class="pre">-c/--column</span></code> option now results in an error message. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/548">#548</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">table.analyze_column()</span></code> method (<a class="reference internal" href="python-api.html#python-api-analyze-column"><span class="std std-ref">documented here</span></a>) now accepts <code class="docutils literal notranslate"><span class="pre">most_common=False</span></code> and <code class="docutils literal notranslate"><span class="pre">least_common=False</span></code> options for disabling calculation of those values.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.31 (2023-05-08)"></a><section id="v3-31">
<span id="id5"></span><h2>3.31 (2023-05-08)<a class="headerlink" href="#v3-31" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Dropped support for Python 3.6. Tests now ensure compatibility with Python 3.11. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/517">#517</a>)</p></li>
<li><p>Automatically locates the SpatiaLite extension on Apple Silicon. Thanks, Chris Amico. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/pull/536">#536</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">--raw-lines</span></code> option for the <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">query</span></code> and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">memory</span></code> commands, which outputs just the raw value of the first column of every row. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/539">#539</a>)</p></li>
<li><p>Fixed a bug where <code class="docutils literal notranslate"><span class="pre">table.upsert_all()</span></code> failed if the <code class="docutils literal notranslate"><span class="pre">not_null=</span></code> option was passed. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/538">#538</a>)</p></li>
<li><p>Fixed a <code class="docutils literal notranslate"><span class="pre">ResourceWarning</span></code> when using <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/534">#534</a>)</p></li>
<li><p>Now shows a more detailed error message when <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span></code> is called with invalid JSON. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/532">#532</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.convert(...,</span> <span class="pre">skip_false=False)</span></code> and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">convert</span> <span class="pre">--no-skip-false</span></code> options, for avoiding a misfeature where the <a class="reference internal" href="python-api.html#python-api-convert"><span class="std std-ref">convert()</span></a> mechanism skips rows in the database with a falsey value for the specified column. Fixing this by default would be a backwards-incompatible change and is under consideration for a 4.0 release in the future. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/527">#527</a>)</p></li>
<li><p>Tables can now be created with self-referential foreign keys. Thanks, Scott Perry. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/pull/537">#537</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">transform</span></code> no longer breaks if a table defines default values for columns. Thanks, Kenny Song. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/509">#509</a>)</p></li>
<li><p>Fixed a bug where repeated calls to <code class="docutils literal notranslate"><span class="pre">table.transform()</span></code> did not work correctly. Thanks, Martin Carpenter. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/525">#525</a>)</p></li>
<li><p>Improved error message if <code class="docutils literal notranslate"><span class="pre">rows_from_file()</span></code> is passed a non-binary-mode file-like object. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/520">#520</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.30 (2022-10-25)"></a><section id="v3-30">
<span id="id6"></span><h2>3.30 (2022-10-25)<a class="headerlink" href="#v3-30" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Now tested against Python 3.11. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/502">#502</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">table.search_sql(include_rank=True)</span></code> option, which adds a <code class="docutils literal notranslate"><span class="pre">rank</span></code> column to the generated SQL. Thanks, Jacob Chapman. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/pull/480">#480</a>)</p></li>
<li><p>Progress bars now display for newline-delimited JSON files using the <code class="docutils literal notranslate"><span class="pre">--nl</span></code> option. Thanks, Mischa Untaga. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/485">#485</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">db.close()</span></code> method. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/504">#504</a>)</p></li>
<li><p>Conversion functions passed to <a class="reference internal" href="python-api.html#python-api-convert"><span class="std std-ref">table.convert(…)</span></a> can now return lists or dictionaries, which will be inserted into the database as JSON strings. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/495">#495</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">install</span></code> and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">uninstall</span></code> commands for installing packages into the same virtual environment as <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span></code>, <a class="reference internal" href="cli.html#cli-install"><span class="std std-ref">described here</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/483">#483</a>)</p></li>
<li><p>New <a class="reference internal" href="reference.html#reference-utils-flatten"><span class="std std-ref">sqlite_utils.utils.flatten()</span></a> utility function. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/500">#500</a>)</p></li>
<li><p>Documentation on <a class="reference internal" href="contributing.html#contributing-just"><span class="std std-ref">using Just</span></a> to run tests, linters and build documentation.</p></li>
<li><p>Documentation now covers the <a class="reference internal" href="contributing.html#release-process"><span class="std std-ref">Release process</span></a> for this package.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.29 (2022-08-27)"></a><section id="v3-29">
<span id="id7"></span><h2>3.29 (2022-08-27)<a class="headerlink" href="#v3-29" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">query</span></code>, <code class="docutils literal notranslate"><span class="pre">memory</span></code> and <code class="docutils literal notranslate"><span class="pre">bulk</span></code> commands now all accept a new <code class="docutils literal notranslate"><span class="pre">--functions</span></code> option. This can be passed a string of Python code, and any callable objects defined in that code will be made available to SQL queries as custom SQL functions. See <a class="reference internal" href="cli.html#cli-query-functions"><span class="std std-ref">Defining custom SQL functions</span></a> for details. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/471">#471</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db[table].create(...)</span></code> method now accepts a new <code class="docutils literal notranslate"><span class="pre">transform=True</span></code> parameter. If the table already exists it will be <a class="reference internal" href="python-api.html#python-api-transform"><span class="std std-ref">transformed</span></a> to match the schema configuration options passed to the function. This may result in columns being added or dropped, column types being changed, column order being updated or not null and default values for columns being set. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/467">#467</a>)</p></li>
<li><p>Related to the above, the <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">create-table</span></code> command now accepts a <code class="docutils literal notranslate"><span class="pre">--transform</span></code> option.</p></li>
<li><p>New introspection property: <code class="docutils literal notranslate"><span class="pre">table.default_values</span></code> returns a dictionary mapping each column name with a default value to the configured default value. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/475">#475</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--load-extension</span></code> option can now be provided a path to a compiled SQLite extension module accompanied by the name of an entrypoint, separated by a colon - for example <code class="docutils literal notranslate"><span class="pre">--load-extension</span> <span class="pre">./lines0:sqlite3_lines0_noread_init</span></code>. This feature is modelled on code first <a class="reference external" href="https://github.com/simonw/datasette/pull/1789">contributed to Datasette</a> by Alex Garcia. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/470">#470</a>)</p></li>
<li><p>Functions registered using the <a class="reference internal" href="python-api.html#python-api-register-function"><span class="std std-ref">db.register_function()</span></a> method can now have a custom name specified using the new <code class="docutils literal notranslate"><span class="pre">db.register_function(fn,</span> <span class="pre">name=...)</span></code> parameter. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/458">#458</a>)</p></li>
<li><p><a class="reference internal" href="cli.html#cli-rows"><span class="std std-ref">sqlite-utils rows</span></a> has a new <code class="docutils literal notranslate"><span class="pre">--order</span></code> option for specifying the sort order for the returned rows. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/469">#469</a>)</p></li>
<li><p>All of the CLI options that accept Python code blocks can now all be used to define functions that can access modules imported in that same block of code without needing to use the <code class="docutils literal notranslate"><span class="pre">global</span></code> keyword. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/472">#472</a>)</p></li>
<li><p>Fixed bug where <code class="docutils literal notranslate"><span class="pre">table.extract()</span></code> would not behave correctly for columns containing null values. Thanks, Forest Gregg. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/423">#423</a>)</p></li>
<li><p>New tutorial: <a class="reference external" href="https://datasette.io/tutorials/clean-data">Cleaning data with sqlite-utils and Datasette</a> shows how to use <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span></code> to import and clean an example CSV file.</p></li>
<li><p>Datasette and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span></code> now have a Discord community. <a class="reference external" href="https://discord.gg/Ass7bCAMDw">Join the Discord here</a>.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.28 (2022-07-15)"></a><section id="v3-28">
<span id="id8"></span><h2>3.28 (2022-07-15)<a class="headerlink" href="#v3-28" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <a class="reference internal" href="python-api.html#python-api-duplicate"><span class="std std-ref">table.duplicate(new_name)</span></a> method for creating a copy of a table with a matching schema and row contents. Thanks, <a class="reference external" href="https://github.com/davidleejy">David</a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/449">#449</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">duplicate</span> <span class="pre">data.db</span> <span class="pre">table_name</span> <span class="pre">new_name</span></code> CLI command for <a class="reference internal" href="cli.html#cli-duplicate-table"><span class="std std-ref">Duplicating tables</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/454">#454</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite_utils.utils.rows_from_file()</span></code> is now a <a class="reference internal" href="reference.html#reference-utils-rows-from-file"><span class="std std-ref">documented API</span></a>. It can be used to read a sequence of dictionaries from a file-like object containing CSV, TSV, JSON or newline-delimited JSON. It can be passed an explicit format or can attempt to detect the format automatically. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/443">#443</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite_utils.utils.TypeTracker</span></code> is now a documented API for detecting the likely column types for a sequence of string rows, see <a class="reference internal" href="python-api.html#python-api-typetracker"><span class="std std-ref">Detecting column types using TypeTracker</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/445">#445</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite_utils.utils.chunks()</span></code> is now a documented API for <a class="reference internal" href="reference.html#reference-utils-chunks"><span class="std std-ref">splitting an iterator into chunks</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/451">#451</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">enable-fts</span></code> now has a <code class="docutils literal notranslate"><span class="pre">--replace</span></code> option for replacing the existing FTS configuration for a table. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/450">#450</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">create-index</span></code>, <code class="docutils literal notranslate"><span class="pre">add-column</span></code> and <code class="docutils literal notranslate"><span class="pre">duplicate</span></code> commands all now take a <code class="docutils literal notranslate"><span class="pre">--ignore</span></code> option for ignoring errors should the database not be in the right state for them to operate. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/450">#450</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.27 (2022-06-14)"></a><section id="v3-27">
<span id="id9"></span><h2>3.27 (2022-06-14)<a class="headerlink" href="#v3-27" title="Link to this heading">#</a></h2>
<p>See also <a class="reference external" href="https://simonwillison.net/2022/Jun/19/weeknotes/#sqlite-utils-3-27">the annotated release notes</a> for this release.</p>
<ul class="simple">
<li><p>Documentation now uses the <a class="reference external" href="https://github.com/pradyunsg/furo">Furo</a> Sphinx theme. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/435">#435</a>)</p></li>
<li><p>Code examples in documentation now have a “copy to clipboard” button. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/436">#436</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite_utils.utils.utils.rows_from_file()</span></code> is now a documented API, see <a class="reference internal" href="python-api.html#python-api-rows-from-file"><span class="std std-ref">Reading rows from a file</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/443">#443</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rows_from_file()</span></code> has two new parameters to help handle CSV files with rows that contain more values than are listed in that CSV file’s headings: <code class="docutils literal notranslate"><span class="pre">ignore_extras=True</span></code> and <code class="docutils literal notranslate"><span class="pre">extras_key="name-of-key"</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/440">#440</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite_utils.utils.maximize_csv_field_size_limit()</span></code> helper function for increasing the field size limit for reading CSV files to its maximum, see <a class="reference internal" href="python-api.html#python-api-maximize-csv-field-size-limit"><span class="std std-ref">Setting the maximum CSV field size limit</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/442">#442</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.search(where=,</span> <span class="pre">where_args=)</span></code> parameters for adding additional <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clauses to a search query. The <code class="docutils literal notranslate"><span class="pre">where=</span></code> parameter is available on <code class="docutils literal notranslate"><span class="pre">table.search_sql(...)</span></code> as well. See <a class="reference internal" href="python-api.html#python-api-fts-search"><span class="std std-ref">Searching with table.search()</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/441">#441</a>)</p></li>
<li><p>Fixed bug where <code class="docutils literal notranslate"><span class="pre">table.detect_fts()</span></code> and other search-related functions could fail if two FTS-enabled tables had names that were prefixes of each other. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/434">#434</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.26.1 (2022-05-02)"></a><section id="v3-26-1">
<span id="id10"></span><h2>3.26.1 (2022-05-02)<a class="headerlink" href="#v3-26-1" title="Link to this heading">#</a></h2>
<ul>
<li><p>Now depends on <a class="reference external" href="https://github.com/simonw/click-default-group-wheel">click-default-group-wheel</a>, a pure Python wheel package. This means you can install and use this package with <a class="reference external" href="https://pyodide.org/">Pyodide</a>, which can run Python entirely in your browser using WebAssembly. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/pull/429">#429</a>)</p>
<p>Try that out using the <a class="reference external" href="https://pyodide.org/en/stable/console.html">Pyodide REPL</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">micropip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">await</span> <span class="n">micropip</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">"sqlite-utils"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sqlite_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">sqlite_utils</span><span class="o">.</span><span class="n">Database</span><span class="p">(</span><span class="n">memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"select 3 * 5"</span><span class="p">))</span>
<span class="go">[{'3 * 5': 15}]</span>
</pre></div>
</div>
</li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.26 (2022-04-13)"></a><section id="v3-26">
<span id="id11"></span><h2>3.26 (2022-04-13)<a class="headerlink" href="#v3-26" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">errors=r.IGNORE/r.SET_NULL</span></code> parameter for the <code class="docutils literal notranslate"><span class="pre">r.parsedatetime()</span></code> and <code class="docutils literal notranslate"><span class="pre">r.parsedate()</span></code> <a class="reference internal" href="cli.html#cli-convert-recipes"><span class="std std-ref">convert recipes</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/416">#416</a>)</p></li>
<li><p>Fixed a bug where <code class="docutils literal notranslate"><span class="pre">--multi</span></code> could not be used in combination with <code class="docutils literal notranslate"><span class="pre">--dry-run</span></code> for the <a class="reference internal" href="cli.html#cli-convert"><span class="std std-ref">convert</span></a> command. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/415">#415</a>)</p></li>
<li><p>New documentation: <a class="reference internal" href="cli.html#cli-convert-complex"><span class="std std-ref">Using a convert() function to execute initialization</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/420">#420</a>)</p></li>
<li><p>More robust detection for whether or not <code class="docutils literal notranslate"><span class="pre">deterministic=True</span></code> is supported. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/425">#425</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.25.1 (2022-03-11)"></a><section id="v3-25-1">
<span id="id12"></span><h2>3.25.1 (2022-03-11)<a class="headerlink" href="#v3-25-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Improved display of type information and parameters in the <a class="reference internal" href="reference.html#reference"><span class="std std-ref">API reference documentation</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/413">#413</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.25 (2022-03-01)"></a><section id="v3-25">
<span id="id13"></span><h2>3.25 (2022-03-01)<a class="headerlink" href="#v3-25" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">hash_id_columns=</span></code> parameter for creating a primary key that’s a hash of the content of specific columns - see <a class="reference internal" href="python-api.html#python-api-hash"><span class="std std-ref">Setting an ID based on the hash of the row contents</span></a> for details. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/343">#343</a>)</p></li>
<li><p>New <a class="reference internal" href="python-api.html#python-api-sqlite-version"><span class="std std-ref">db.sqlite_version</span></a> property, returning a tuple of integers representing the version of SQLite, for example <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">38,</span> <span class="pre">0)</span></code>.</p></li>
<li><p>Fixed a bug where <a class="reference internal" href="python-api.html#python-api-register-function"><span class="std std-ref">register_function(deterministic=True)</span></a> caused errors on versions of SQLite prior to 3.8.3. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/408">#408</a>)</p></li>
<li><p>New documented <a class="reference internal" href="reference.html#reference-utils-hash-record"><span class="std std-ref">hash_record(record, keys=…)</span></a> function.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.24 (2022-02-15)"></a><section id="v3-24">
<span id="id14"></span><h2>3.24 (2022-02-15)<a class="headerlink" href="#v3-24" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>SpatiaLite helpers for the <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span></code> command-line tool - thanks, Chris Amico. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/398">#398</a>)</p>
<ul>
<li><p><a class="reference internal" href="cli.html#cli-create-database"><span class="std std-ref">sqlite-utils create-database</span></a> <code class="docutils literal notranslate"><span class="pre">--init-spatialite</span></code> option for initializing SpatiaLite on a newly created database.</p></li>
<li><p><a class="reference internal" href="cli.html#cli-spatialite"><span class="std std-ref">sqlite-utils add-geometry-column</span></a> command for adding geometry columns.</p></li>
<li><p><a class="reference internal" href="cli.html#cli-spatialite-indexes"><span class="std std-ref">sqlite-utils create-spatial-index</span></a> command for adding spatial indexes.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">db[table].create(...,</span> <span class="pre">if_not_exists=True)</span></code> option for <a class="reference internal" href="python-api.html#python-api-explicit-create"><span class="std std-ref">creating a table</span></a> only if it does not already exist. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/397">#397</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Database(memory_name="my_shared_database")</span></code> parameter for creating a <a class="reference internal" href="python-api.html#python-api-connect"><span class="std std-ref">named in-memory database</span></a> that can be shared between multiple connections. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/405">#405</a>)</p></li>
<li><p>Documentation now describes <a class="reference internal" href="cli.html#cli-transform-table-add-primary-key-to-rowid"><span class="std std-ref">how to add a primary key to a rowid table</span></a> using <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">transform</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/403">#403</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.23 (2022-02-03)"></a><section id="v3-23">
<span id="id15"></span><h2>3.23 (2022-02-03)<a class="headerlink" href="#v3-23" title="Link to this heading">#</a></h2>
<p>This release introduces four new utility methods for working with <a class="reference external" href="https://www.gaia-gis.it/fossil/libspatialite/index">SpatiaLite</a>. Thanks, Chris Amico. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/pull/385">#385</a>)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite_utils.utils.find_spatialite()</span></code> <a class="reference internal" href="python-api.html#python-api-gis-find-spatialite"><span class="std std-ref">finds the location of the SpatiaLite module</span></a> on disk.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db.init_spatialite()</span></code> <a class="reference internal" href="python-api.html#python-api-gis-init-spatialite"><span class="std std-ref">initializes SpatiaLite</span></a> for the given database.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.add_geometry_column(...)</span></code> <a class="reference internal" href="python-api.html#python-api-gis-add-geometry-column"><span class="std std-ref">adds a geometry column</span></a> to an existing table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.create_spatial_index(...)</span></code> <a class="reference internal" href="python-api.html#python-api-gis-create-spatial-index"><span class="std std-ref">creates a spatial index</span></a> for a column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">batch</span></code> now accepts a <code class="docutils literal notranslate"><span class="pre">--batch-size</span></code> option. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/392">#392</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.22.1 (2022-01-25)"></a><section id="v3-22-1">
<span id="id16"></span><h2>3.22.1 (2022-01-25)<a class="headerlink" href="#v3-22-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>All commands now include example usage in their <code class="docutils literal notranslate"><span class="pre">--help</span></code> - see <a class="reference internal" href="cli-reference.html#cli-reference"><span class="std std-ref">CLI reference</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/384">#384</a>)</p></li>
<li><p>Python library documentation has a new <a class="reference internal" href="python-api.html#python-api-getting-started"><span class="std std-ref">Getting started</span></a> section. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/387">#387</a>)</p></li>
<li><p>Documentation now uses <a class="reference external" href="https://plausible.io/">Plausible analytics</a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/389">#389</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.22 (2022-01-11)"></a><section id="v3-22">
<span id="id17"></span><h2>3.22 (2022-01-11)<a class="headerlink" href="#v3-22" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <a class="reference internal" href="cli-reference.html#cli-reference"><span class="std std-ref">CLI reference</span></a> documentation page, listing the output of <code class="docutils literal notranslate"><span class="pre">--help</span></code> for every one of the CLI commands. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/383">#383</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">rows</span></code> now has <code class="docutils literal notranslate"><span class="pre">--limit</span></code> and <code class="docutils literal notranslate"><span class="pre">--offset</span></code> options for paginating through data. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/381">#381</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">rows</span></code> now has <code class="docutils literal notranslate"><span class="pre">--where</span></code> and <code class="docutils literal notranslate"><span class="pre">-p</span></code> options for filtering the table using a <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> query, see <a class="reference internal" href="cli.html#cli-rows"><span class="std std-ref">Returning all rows in a table</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/382">#382</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.21 (2022-01-10)"></a><section id="v3-21">
<span id="id18"></span><h2>3.21 (2022-01-10)<a class="headerlink" href="#v3-21" title="Link to this heading">#</a></h2>
<p>CLI and Python library improvements to help run <a class="reference external" href="https://www.sqlite.org/lang_analyze.html">ANALYZE</a> after creating indexes or inserting rows, to gain better performance from the SQLite query planner when it runs against indexes.</p>
<p>Three new CLI commands: <code class="docutils literal notranslate"><span class="pre">create-database</span></code>, <code class="docutils literal notranslate"><span class="pre">analyze</span></code> and <code class="docutils literal notranslate"><span class="pre">bulk</span></code>.</p>
<p>More details and examples can be found in <a class="reference external" href="https://simonwillison.net/2022/Jan/11/sqlite-utils/">the annotated release notes</a>.</p>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">create-database</span></code> command for creating new empty database files. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/348">#348</a>)</p></li>
<li><p>New Python methods for running <code class="docutils literal notranslate"><span class="pre">ANALYZE</span></code> against a database, table or index: <code class="docutils literal notranslate"><span class="pre">db.analyze()</span></code> and <code class="docutils literal notranslate"><span class="pre">table.analyze()</span></code>, see <a class="reference internal" href="python-api.html#python-api-analyze"><span class="std std-ref">Optimizing index usage with ANALYZE</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/366">#366</a>)</p></li>
<li><p>New <a class="reference internal" href="cli.html#cli-analyze"><span class="std std-ref">sqlite-utils analyze command</span></a> for running <code class="docutils literal notranslate"><span class="pre">ANALYZE</span></code> using the CLI. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/379">#379</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">create-index</span></code>, <code class="docutils literal notranslate"><span class="pre">insert</span></code> and <code class="docutils literal notranslate"><span class="pre">upsert</span></code> commands now have a new <code class="docutils literal notranslate"><span class="pre">--analyze</span></code> option for running <code class="docutils literal notranslate"><span class="pre">ANALYZE</span></code> after the command has completed. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/379">#379</a>)</p></li>
<li><p>New <a class="reference internal" href="cli.html#cli-bulk"><span class="std std-ref">sqlite-utils bulk command</span></a> which can import records in the same way as <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span></code> (from JSON, CSV or TSV) and use them to bulk execute a parametrized SQL query. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/375">#375</a>)</p></li>
<li><p>The CLI tool can now also be run using <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">sqlite_utils</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/368">#368</a>)</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">--fmt</span></code> now implies <code class="docutils literal notranslate"><span class="pre">--table</span></code>, so you don’t need to pass both options. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/374">#374</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--convert</span></code> function applied to rows can now modify the row in place. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/371">#371</a>)</p></li>
<li><p>The <a class="reference internal" href="cli.html#cli-insert-files"><span class="std std-ref">insert-files command</span></a> supports two new columns: <code class="docutils literal notranslate"><span class="pre">stem</span></code> and <code class="docutils literal notranslate"><span class="pre">suffix</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/372">#372</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--nl</span></code> import option now ignores blank lines in the input. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/376">#376</a>)</p></li>
<li><p>Fixed bug where streaming input to the <code class="docutils literal notranslate"><span class="pre">insert</span></code> command with <code class="docutils literal notranslate"><span class="pre">--batch-size</span> <span class="pre">1</span></code> would appear to only commit after several rows had been ingested, due to unnecessary input buffering. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/364">#364</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.20 (2022-01-05)"></a><section id="v3-20">
<span id="id19"></span><h2>3.20 (2022-01-05)<a class="headerlink" href="#v3-20" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span> <span class="pre">...</span> <span class="pre">--lines</span></code> to insert the lines from a file into a table with a single <code class="docutils literal notranslate"><span class="pre">line</span></code> column, see <a class="reference internal" href="cli.html#cli-insert-unstructured"><span class="std std-ref">Inserting unstructured data with --lines and --text</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span> <span class="pre">...</span> <span class="pre">--text</span></code> to insert the contents of the file into a table with a single <code class="docutils literal notranslate"><span class="pre">text</span></code> column and a single row.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span> <span class="pre">...</span> <span class="pre">--convert</span></code> allows a Python function to be provided that will be used to convert each row that is being inserted into the database. See <a class="reference internal" href="cli.html#cli-insert-convert"><span class="std std-ref">Applying conversions while inserting data</span></a>, including details on special behavior when combined with <code class="docutils literal notranslate"><span class="pre">--lines</span></code> and <code class="docutils literal notranslate"><span class="pre">--text</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/356">#356</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">convert</span></code> now accepts a code value of <code class="docutils literal notranslate"><span class="pre">-</span></code> to read code from standard input. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/353">#353</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">convert</span></code> also now accepts code that defines a named <code class="docutils literal notranslate"><span class="pre">convert(value)</span></code> function, see <a class="reference internal" href="cli.html#cli-convert"><span class="std std-ref">Converting data in columns</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db.supports_strict</span></code> property showing if the database connection supports <a class="reference external" href="https://www.sqlite.org/stricttables.html">SQLite strict tables</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.strict</span></code> property (see <a class="reference internal" href="python-api.html#python-api-introspection-strict"><span class="std std-ref">.strict</span></a>) indicating if the table uses strict mode. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/344">#344</a>)</p></li>
<li><p>Fixed bug where <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">upsert</span> <span class="pre">...</span> <span class="pre">--detect-types</span></code> ignored the <code class="docutils literal notranslate"><span class="pre">--detect-types</span></code> option. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/362">#362</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.19 (2021-11-20)"></a><section id="v3-19">
<span id="id20"></span><h2>3.19 (2021-11-20)<a class="headerlink" href="#v3-19" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The <a class="reference internal" href="python-api.html#python-api-lookup-tables"><span class="std std-ref">table.lookup() method</span></a> now accepts keyword arguments that match those on the underlying <code class="docutils literal notranslate"><span class="pre">table.insert()</span></code> method: <code class="docutils literal notranslate"><span class="pre">foreign_keys=</span></code>, <code class="docutils literal notranslate"><span class="pre">column_order=</span></code>, <code class="docutils literal notranslate"><span class="pre">not_null=</span></code>, <code class="docutils literal notranslate"><span class="pre">defaults=</span></code>, <code class="docutils literal notranslate"><span class="pre">extracts=</span></code>, <code class="docutils literal notranslate"><span class="pre">conversions=</span></code> and <code class="docutils literal notranslate"><span class="pre">columns=</span></code>. You can also now pass <code class="docutils literal notranslate"><span class="pre">pk=</span></code> to specify a different column name to use for the primary key. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/342">#342</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.18 (2021-11-14)"></a><section id="v3-18">
<span id="id21"></span><h2>3.18 (2021-11-14)<a class="headerlink" href="#v3-18" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">table.lookup()</span></code> method now has an optional second argument which can be used to populate columns only the first time the record is created, see <a class="reference internal" href="python-api.html#python-api-lookup-tables"><span class="std std-ref">Working with lookup tables</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/339">#339</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">memory</span></code> now has a <code class="docutils literal notranslate"><span class="pre">--flatten</span></code> option for <a class="reference internal" href="cli.html#cli-inserting-data-flatten"><span class="std std-ref">flattening nested JSON objects</span></a> into separate columns, consistent with <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/332">#332</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.create_index(...,</span> <span class="pre">find_unique_name=True)</span></code> parameter, which finds an available name for the created index even if the default name has already been taken. This means that <code class="docutils literal notranslate"><span class="pre">index-foreign-keys</span></code> will work even if one of the indexes it tries to create clashes with an existing index name. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/335">#335</a>)</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">py.typed</span></code> to the module, so <a class="reference external" href="http://mypy-lang.org/">mypy</a> should now correctly pick up the type annotations. Thanks, Andreas Longo. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/331">#331</a>)</p></li>
<li><p>Now depends on <code class="docutils literal notranslate"><span class="pre">python-dateutil</span></code> instead of depending on <code class="docutils literal notranslate"><span class="pre">dateutils</span></code>. Thanks, Denys Pavlov. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/324">#324</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.create()</span></code> (see <a class="reference internal" href="python-api.html#python-api-explicit-create"><span class="std std-ref">Explicitly creating a table</span></a>) now handles <code class="docutils literal notranslate"><span class="pre">dict</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">tuple</span></code> types, mapping them to <code class="docutils literal notranslate"><span class="pre">TEXT</span></code> columns in SQLite so that they can be stored encoded as JSON. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/338">#338</a>)</p></li>
<li><p>Inserted data with square braces in the column names (for example a CSV file containing a <code class="docutils literal notranslate"><span class="pre">item[price]</span></code>) column now have the braces converted to underscores: <code class="docutils literal notranslate"><span class="pre">item_price_</span></code>. Previously such columns would be rejected with an error. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/329">#329</a>)</p></li>
<li><p>Now also tested against Python 3.10. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/pull/330">#330</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.17.1 (2021-09-22)"></a><section id="v3-17-1">
<span id="id22"></span><h2>3.17.1 (2021-09-22)<a class="headerlink" href="#v3-17-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="cli.html#cli-memory"><span class="std std-ref">sqlite-utils memory</span></a> now works if files passed to it share the same file name. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/325">#325</a>)</p></li>
<li><p><a class="reference internal" href="cli.html#cli-query"><span class="std std-ref">sqlite-utils query</span></a> now returns <code class="docutils literal notranslate"><span class="pre">[]</span></code> in JSON mode if no rows are returned. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/328">#328</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.17 (2021-08-24)"></a><section id="v3-17">
<span id="id23"></span><h2>3.17 (2021-08-24)<a class="headerlink" href="#v3-17" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The <a class="reference internal" href="cli.html#cli-memory"><span class="std std-ref">sqlite-utils memory</span></a> command has a new <code class="docutils literal notranslate"><span class="pre">--analyze</span></code> option, which runs the equivalent of the <a class="reference internal" href="cli.html#cli-analyze-tables"><span class="std std-ref">analyze-tables</span></a> command directly against the in-memory database created from the incoming CSV or JSON data. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/320">#320</a>)</p></li>
<li><p><a class="reference internal" href="cli.html#cli-insert-files"><span class="std std-ref">sqlite-utils insert-files</span></a> now has the ability to insert file contents in to <code class="docutils literal notranslate"><span class="pre">TEXT</span></code> columns in addition to the default <code class="docutils literal notranslate"><span class="pre">BLOB</span></code>. Pass the <code class="docutils literal notranslate"><span class="pre">--text</span></code> option or use <code class="docutils literal notranslate"><span class="pre">content_text</span></code> as a column specifier. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/319">#319</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.16 (2021-08-18)"></a><section id="v3-16">
<span id="id24"></span><h2>3.16 (2021-08-18)<a class="headerlink" href="#v3-16" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Type signatures added to  more methods, including <code class="docutils literal notranslate"><span class="pre">table.resolve_foreign_keys()</span></code>, <code class="docutils literal notranslate"><span class="pre">db.create_table_sql()</span></code>, <code class="docutils literal notranslate"><span class="pre">db.create_table()</span></code> and <code class="docutils literal notranslate"><span class="pre">table.create()</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/314">#314</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">db.quote_fts(value)</span></code> method, see <a class="reference internal" href="python-api.html#python-api-quote-fts"><span class="std std-ref">Quoting characters for use in search</span></a> - thanks, Mark Neumann. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/246">#246</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.search()</span></code> now accepts an optional <code class="docutils literal notranslate"><span class="pre">quote=True</span></code> parameter. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/296">#296</a>)</p></li>
<li><p>CLI command <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">search</span></code> now accepts a <code class="docutils literal notranslate"><span class="pre">--quote</span></code> option. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/296">#296</a>)</p></li>
<li><p>Fixed bug where <code class="docutils literal notranslate"><span class="pre">--no-headers</span></code> and <code class="docutils literal notranslate"><span class="pre">--tsv</span></code> options to <a class="reference internal" href="cli.html#cli-insert-csv-tsv"><span class="std std-ref">sqlite-utils insert</span></a> could not be used together. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/295">#295</a>)</p></li>
<li><p>Various small improvements to <a class="reference internal" href="reference.html#reference"><span class="std std-ref">API reference</span></a> documentation.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.15.1 (2021-08-10)"></a><section id="v3-15-1">
<span id="id25"></span><h2>3.15.1 (2021-08-10)<a class="headerlink" href="#v3-15-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Python library now includes type annotations on almost all of the methods, plus detailed docstrings describing each one. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/311">#311</a>)</p></li>
<li><p>New <a class="reference internal" href="reference.html#reference"><span class="std std-ref">API reference</span></a> documentation page, powered by those docstrings.</p></li>
<li><p>Fixed bug where <code class="docutils literal notranslate"><span class="pre">.add_foreign_keys()</span></code> failed to raise an error if called against a <code class="docutils literal notranslate"><span class="pre">View</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/313">#313</a>)</p></li>
<li><p>Fixed bug where <code class="docutils literal notranslate"><span class="pre">.delete_where()</span></code> returned a <code class="docutils literal notranslate"><span class="pre">[]</span></code> instead of returning <code class="docutils literal notranslate"><span class="pre">self</span></code> if called against a non-existent table. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/315">#315</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.15 (2021-08-09)"></a><section id="v3-15">
<span id="id26"></span><h2>3.15 (2021-08-09)<a class="headerlink" href="#v3-15" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span> <span class="pre">--flatten</span></code> option for <a class="reference internal" href="cli.html#cli-inserting-data-flatten"><span class="std std-ref">flattening nested JSON objects</span></a> to create tables with column names like <code class="docutils literal notranslate"><span class="pre">topkey_nestedkey</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/310">#310</a>)</p></li>
<li><p>Fixed several spelling mistakes in the documentation, spotted <a class="reference external" href="https://til.simonwillison.net/python/codespell">using codespell</a>.</p></li>
<li><p>Errors that occur while using the <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span></code> CLI tool now show the responsible SQL and query parameters, if possible. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/309">#309</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.14 (2021-08-02)"></a><section id="v3-14">
<span id="id27"></span><h2>3.14 (2021-08-02)<a class="headerlink" href="#v3-14" title="Link to this heading">#</a></h2>
<p>This release introduces the new <a class="reference internal" href="cli.html#cli-convert"><span class="std std-ref">sqlite-utils convert command</span></a> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/251">#251</a>) and corresponding <a class="reference internal" href="python-api.html#python-api-convert"><span class="std std-ref">table.convert(…)</span></a> Python method (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/302">#302</a>). These tools can be used to apply a Python conversion function to one or more columns of a table, either updating the column in place or using transformed data from that column to populate one or more other columns.</p>
<p>This command-line example uses the Python standard library <a class="reference external" href="https://docs.python.org/3/library/textwrap.html">textwrap module</a> to wrap the content of the <code class="docutils literal notranslate"><span class="pre">content</span></code> column in the <code class="docutils literal notranslate"><span class="pre">articles</span></code> table to 100 characters:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sqlite-utils convert content.db articles content \
    '"\n".join(textwrap.wrap(value, 100))' \
    --import=textwrap
</pre></div>
</div>
<p>The same operation in Python code looks like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite_utils</span><span class="o">,</span> <span class="nn">textwrap</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">sqlite_utils</span><span class="o">.</span><span class="n">Database</span><span class="p">(</span><span class="s2">"content.db"</span><span class="p">)</span>
<span class="n">db</span><span class="p">[</span><span class="s2">"articles"</span><span class="p">]</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">"content"</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">100</span><span class="p">)))</span>
</pre></div>
</div>
<p>See the full documentation for the <a class="reference internal" href="cli.html#cli-convert"><span class="std std-ref">sqlite-utils convert command</span></a> and the <a class="reference internal" href="python-api.html#python-api-convert"><span class="std std-ref">table.convert(…)</span></a> Python method for more details.</p>
<p>Also in this release:</p>
<ul class="simple">
<li><p>The new <code class="docutils literal notranslate"><span class="pre">table.count_where(...)</span></code> method, for counting rows in a table that match a specific SQL <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/305">#305</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">--silent</span></code> option for the <a class="reference internal" href="cli.html#cli-insert-files"><span class="std std-ref">sqlite-utils insert-files command</span></a> to hide the terminal progress bar, consistent with the <code class="docutils literal notranslate"><span class="pre">--silent</span></code> option for <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">convert</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/301">#301</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.13 (2021-07-24)"></a><section id="v3-13">
<span id="id28"></span><h2>3.13 (2021-07-24)<a class="headerlink" href="#v3-13" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">schema</span> <span class="pre">my.db</span> <span class="pre">table1</span> <span class="pre">table2</span></code> command now accepts optional table names. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/299">#299</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">memory</span> <span class="pre">--help</span></code> now describes the <code class="docutils literal notranslate"><span class="pre">--schema</span></code> option.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.12 (2021-06-25)"></a><section id="v3-12">
<span id="id29"></span><h2>3.12 (2021-06-25)<a class="headerlink" href="#v3-12" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <a class="reference internal" href="python-api.html#python-api-query"><span class="std std-ref">db.query(sql, params)</span></a> method, which executes a SQL query and returns the results as an iterator over Python dictionaries. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/290">#290</a>)</p></li>
<li><p>This project now uses <code class="docutils literal notranslate"><span class="pre">flake8</span></code> and has started to use <code class="docutils literal notranslate"><span class="pre">mypy</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/291">#291</a>)</p></li>
<li><p>New documentation on <a class="reference internal" href="contributing.html#contributing"><span class="std std-ref">contributing</span></a> to this project. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/292">#292</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.11 (2021-06-20)"></a><section id="v3-11">
<span id="id30"></span><h2>3.11 (2021-06-20)<a class="headerlink" href="#v3-11" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">memory</span> <span class="pre">data.csv</span> <span class="pre">--schema</span></code> option, for outputting the schema of the in-memory database generated from one or more files. See <a class="reference internal" href="cli.html#cli-memory-schema-dump-save"><span class="std std-ref">--schema, --analyze, --dump and --save</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/288">#288</a>)</p></li>
<li><p>Added <a class="reference internal" href="installation.html#installation"><span class="std std-ref">installation instructions</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/286">#286</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.10 (2021-06-19)"></a><section id="v3-10">
<span id="id31"></span><h2>3.10 (2021-06-19)<a class="headerlink" href="#v3-10" title="Link to this heading">#</a></h2>
<p>This release introduces the <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">memory</span></code> command, which can be used to load CSV or JSON data into a temporary in-memory database and run SQL queries (including joins across multiple files) directly against that data.</p>
<p>Also new: <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span> <span class="pre">--detect-types</span></code>, <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">dump</span></code>, <code class="docutils literal notranslate"><span class="pre">table.use_rowid</span></code> plus some smaller fixes.</p>
<section id="sqlite-utils-memory">
<h3>sqlite-utils memory<a class="headerlink" href="#sqlite-utils-memory" title="Link to this heading">#</a></h3>
<p>This example of <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">memory</span></code> retrieves information about the all of the repositories in the <a class="reference external" href="https://github.com/dogsheep">Dogsheep</a> organization on GitHub using <a class="reference external" href="https://api.github.com/users/dogsheep/repos">this JSON API</a>, sorts them by their number of stars and outputs a table of the top five (using <code class="docutils literal notranslate"><span class="pre">-t</span></code>):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ curl -s 'https://api.github.com/users/dogsheep/repos' \
  | sqlite-utils memory - '
      select full_name, forks_count, stargazers_count
      from stdin order by stargazers_count desc limit 5
    ' -t
full_name                            forks_count    stargazers_count
---------------------------------  -------------  ------------------
dogsheep/twitter-to-sqlite                    12                 225
dogsheep/github-to-sqlite                     14                 139
dogsheep/dogsheep-photos                       5                 116
dogsheep/dogsheep.github.io                    7                  90
dogsheep/healthkit-to-sqlite                   4                  85
</pre></div>
</div>
<p>The tool works against files on disk as well. This example joins data from two CSV files:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cat creatures.csv
species_id,name
1,Cleo
2,Bants
2,Dori
2,Azi
$ cat species.csv
id,species_name
1,Dog
2,Chicken
$ sqlite-utils memory species.csv creatures.csv '
  select * from creatures join species on creatures.species_id = species.id
'
[{"species_id": 1, "name": "Cleo", "id": 1, "species_name": "Dog"},
 {"species_id": 2, "name": "Bants", "id": 2, "species_name": "Chicken"},
 {"species_id": 2, "name": "Dori", "id": 2, "species_name": "Chicken"},
 {"species_id": 2, "name": "Azi", "id": 2, "species_name": "Chicken"}]
</pre></div>
</div>
<p>Here the <code class="docutils literal notranslate"><span class="pre">species.csv</span></code> file becomes the <code class="docutils literal notranslate"><span class="pre">species</span></code> table, the <code class="docutils literal notranslate"><span class="pre">creatures.csv</span></code> file becomes the <code class="docutils literal notranslate"><span class="pre">creatures</span></code> table and the output is JSON, the default output format.</p>
<p>You can also use the <code class="docutils literal notranslate"><span class="pre">--attach</span></code> option to attach existing SQLite database files to the in-memory database, in order to join data from CSV or JSON directly against your existing tables.</p>
<p>Full documentation of this new feature is available in <a class="reference internal" href="cli.html#cli-memory"><span class="std std-ref">Querying data directly using an in-memory database</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/272">#272</a>)</p>
</section>
<section id="sqlite-utils-insert-detect-types">
<h3>sqlite-utils insert --detect-types<a class="headerlink" href="#sqlite-utils-insert-detect-types" title="Link to this heading">#</a></h3>
<p>The <a class="reference internal" href="cli.html#cli-inserting-data"><span class="std std-ref">sqlite-utils insert</span></a> command can be used to insert data from JSON, CSV or TSV files into a SQLite database file. The new <code class="docutils literal notranslate"><span class="pre">--detect-types</span></code> option (shortcut <code class="docutils literal notranslate"><span class="pre">-d</span></code>), when used in conjunction with a CSV or TSV import, will automatically detect if columns in the file are integers or floating point numbers as opposed to treating everything as a text column and create the new table with the corresponding schema. See <a class="reference internal" href="cli.html#cli-insert-csv-tsv"><span class="std std-ref">Inserting CSV or TSV data</span></a> for details. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/282">#282</a>)</p>
</section>
<section id="other-changes">
<h3>Other changes<a class="headerlink" href="#other-changes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Bug fix</strong>: <code class="docutils literal notranslate"><span class="pre">table.transform()</span></code>, when run against a table without explicit primary keys, would incorrectly create a new version of the table with an explicit primary key column called <code class="docutils literal notranslate"><span class="pre">rowid</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/284">#284</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">table.use_rowid</span></code> introspection property, see <a class="reference internal" href="python-api.html#python-api-introspection-use-rowid"><span class="std std-ref">.use_rowid</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/285">#285</a>)</p></li>
<li><p>The new <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">dump</span> <span class="pre">file.db</span></code> command outputs a SQL dump that can be used to recreate a database. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/274">#274</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-h</span></code> now works as a shortcut for <code class="docutils literal notranslate"><span class="pre">--help</span></code>, thanks Loren McIntyre. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/276">#276</a>)</p></li>
<li><p>Now using <a class="reference external" href="https://pytest-cov.readthedocs.io/">pytest-cov</a> and <a class="reference external" href="https://about.codecov.io/">Codecov</a> to track test coverage - currently at 96%. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/275">#275</a>)</p></li>
<li><p>SQL errors that occur when using <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">query</span></code> are now displayed as CLI errors.</p></li>
</ul>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.9.1 (2021-06-12)"></a><section id="v3-9-1">
<span id="id32"></span><h2>3.9.1 (2021-06-12)<a class="headerlink" href="#v3-9-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Fixed bug when using <code class="docutils literal notranslate"><span class="pre">table.upsert_all()</span></code> to create a table with only a single column that is treated as the primary key. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/271">#271</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.9 (2021-06-11)"></a><section id="v3-9">
<span id="id33"></span><h2>3.9 (2021-06-11)<a class="headerlink" href="#v3-9" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">schema</span></code> command showing the full SQL schema for a database, see <a class="reference internal" href="cli.html#cli-schema"><span class="std std-ref">Showing the schema (CLI)</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/268">#268</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db.schema</span></code> introspection property exposing the same feature to the Python library, see <a class="reference internal" href="python-api.html#python-api-schema"><span class="std std-ref">Showing the schema (Python library)</span></a>.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.8 (2021-06-02)"></a><section id="v3-8">
<span id="id34"></span><h2>3.8 (2021-06-02)<a class="headerlink" href="#v3-8" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">indexes</span></code> command to list indexes in a database, see <a class="reference internal" href="cli.html#cli-indexes"><span class="std std-ref">Listing indexes</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/263">#263</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.xindexes</span></code> introspection property returning more details about that table’s indexes, see <a class="reference internal" href="python-api.html#python-api-introspection-xindexes"><span class="std std-ref">.xindexes</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/261">#261</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.7 (2021-05-28)"></a><section id="v3-7">
<span id="id35"></span><h2>3.7 (2021-05-28)<a class="headerlink" href="#v3-7" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">table.pks_and_rows_where()</span></code> method returning <code class="docutils literal notranslate"><span class="pre">(primary_key,</span> <span class="pre">row_dictionary)</span></code> tuples - see <a class="reference internal" href="python-api.html#python-api-pks-and-rows-where"><span class="std std-ref">Listing rows with their primary keys</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/240">#240</a>)</p></li>
<li><p>Fixed bug with <code class="docutils literal notranslate"><span class="pre">table.add_foreign_key()</span></code> against columns containing spaces. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/238">#238</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table_or_view.drop(ignore=True)</span></code> option for avoiding errors if the table or view does not exist. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/237">#237</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">drop-view</span> <span class="pre">--ignore</span></code> and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">drop-table</span> <span class="pre">--ignore</span></code> options. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/237">#237</a>)</p></li>
<li><p>Fixed a bug with inserts of nested JSON containing non-ascii strings - thanks, Dylan Wu. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/257">#257</a>)</p></li>
<li><p>Suggest <code class="docutils literal notranslate"><span class="pre">--alter</span></code> if an error occurs caused by a missing column. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/259">#259</a>)</p></li>
<li><p>Support creating indexes with columns in descending order, see <a class="reference internal" href="python-api.html#python-api-create-index"><span class="std std-ref">API documentation</span></a> and <a class="reference internal" href="cli.html#cli-create-index"><span class="std std-ref">CLI documentation</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/260">#260</a>)</p></li>
<li><p>Correctly handle CSV files that start with a UTF-8 BOM. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/250">#250</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.6 (2021-02-18)"></a><section id="v3-6">
<span id="id36"></span><h2>3.6 (2021-02-18)<a class="headerlink" href="#v3-6" title="Link to this heading">#</a></h2>
<p>This release adds the ability to execute queries joining data from more than one database file - similar to the cross database querying feature introduced in <a class="reference external" href="https://docs.datasette.io/en/stable/changelog.html#v0-55">Datasette 0.55</a>.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">db.attach(alias,</span> <span class="pre">filepath)</span></code> Python method can be used to attach extra databases to the same connection, see <a class="reference internal" href="python-api.html#python-api-attach"><span class="std std-ref">db.attach() in the Python API documentation</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/113">#113</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--attach</span></code> option attaches extra aliased databases to run SQL queries against directly on the command-line, see <a class="reference internal" href="cli.html#cli-query-attach"><span class="std std-ref">attaching additional databases in the CLI documentation</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/236">#236</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.5 (2021-02-14)"></a><section id="v3-5">
<span id="id37"></span><h2>3.5 (2021-02-14)<a class="headerlink" href="#v3-5" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span> <span class="pre">--sniff</span></code> option for detecting the delimiter and quote character used by a CSV file, see <a class="reference internal" href="cli.html#cli-insert-csv-tsv-delimiter"><span class="std std-ref">Alternative delimiters and quote characters</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/230">#230</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">table.rows_where()</span></code>, <code class="docutils literal notranslate"><span class="pre">table.search()</span></code> and <code class="docutils literal notranslate"><span class="pre">table.search_sql()</span></code> methods all now take optional <code class="docutils literal notranslate"><span class="pre">offset=</span></code> and <code class="docutils literal notranslate"><span class="pre">limit=</span></code> arguments. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/231">#231</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">--no-headers</span></code> option for <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span> <span class="pre">--csv</span></code> to handle CSV files that are missing the header row, see <a class="reference internal" href="cli.html#cli-insert-csv-tsv-no-header"><span class="std std-ref">CSV files without a header row</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/228">#228</a>)</p></li>
<li><p>Fixed bug where inserting data with extra columns in subsequent chunks would throw an error. Thanks <a class="reference external" href="https://github.com/nieuwenhoven">@nieuwenhoven</a> for the fix. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/234">#234</a>)</p></li>
<li><p>Fixed bug importing CSV files with columns containing more than 128KB of data. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/229">#229</a>)</p></li>
<li><p>Test suite now runs in CI against Ubuntu, macOS and Windows. Thanks <a class="reference external" href="https://github.com/nieuwenhoven">@nieuwenhoven</a> for the Windows test fixes. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/232">#232</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.4.1 (2021-02-05)"></a><section id="v3-4-1">
<span id="id38"></span><h2>3.4.1 (2021-02-05)<a class="headerlink" href="#v3-4-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Fixed a code import bug that slipped in to 3.4. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/226">#226</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.4 (2021-02-05)"></a><section id="v3-4">
<span id="id39"></span><h2>3.4 (2021-02-05)<a class="headerlink" href="#v3-4" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span> <span class="pre">--csv</span></code> now accepts optional <code class="docutils literal notranslate"><span class="pre">--delimiter</span></code> and <code class="docutils literal notranslate"><span class="pre">--quotechar</span></code> options. See <a class="reference internal" href="cli.html#cli-insert-csv-tsv-delimiter"><span class="std std-ref">Alternative delimiters and quote characters</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/223">#223</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.3 (2021-01-17)"></a><section id="v3-3">
<span id="id40"></span><h2>3.3 (2021-01-17)<a class="headerlink" href="#v3-3" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">table.m2m()</span></code> method now accepts an optional <code class="docutils literal notranslate"><span class="pre">alter=True</span></code> argument to specify that any missing columns should be added to the referenced table. See <a class="reference internal" href="python-api.html#python-api-m2m"><span class="std std-ref">Working with many-to-many relationships</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/222">#222</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.1 (2021-01-12)"></a><section id="v3-2-1">
<span id="id41"></span><h2>3.2.1 (2021-01-12)<a class="headerlink" href="#v3-2-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Fixed a bug where <code class="docutils literal notranslate"><span class="pre">.add_missing_columns()</span></code> failed to take case insensitive column names into account. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/221">#221</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.2 (2021-01-03)"></a><section id="v3-2">
<span id="id42"></span><h2>3.2 (2021-01-03)<a class="headerlink" href="#v3-2" title="Link to this heading">#</a></h2>
<p>This release introduces a new mechanism for speeding up <code class="docutils literal notranslate"><span class="pre">count(*)</span></code> queries using cached table counts, stored in a <code class="docutils literal notranslate"><span class="pre">_counts</span></code> table and updated by triggers. This mechanism is described in <a class="reference internal" href="python-api.html#python-api-cached-table-counts"><span class="std std-ref">Cached table counts using triggers</span></a>, and can be enabled using Python API methods or the new <code class="docutils literal notranslate"><span class="pre">enable-counts</span></code> CLI command. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/212">#212</a>)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">table.enable_counts()</span></code> method for enabling these triggers on a specific table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db.enable_counts()</span></code> method for enabling triggers on every table in the database. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/213">#213</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">enable-counts</span> <span class="pre">my.db</span></code> command for enabling counts on all or specific tables, see <a class="reference internal" href="cli.html#cli-enable-counts"><span class="std std-ref">Enabling cached counts</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/214">#214</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">triggers</span></code> command for listing the triggers defined for a database or specific tables, see <a class="reference internal" href="cli.html#cli-triggers"><span class="std std-ref">Listing triggers</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/218">#218</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">db.use_counts_table</span></code> property which, if <code class="docutils literal notranslate"><span class="pre">True</span></code>, causes <code class="docutils literal notranslate"><span class="pre">table.count</span></code> to read from the <code class="docutils literal notranslate"><span class="pre">_counts</span></code> table. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/215">#215</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.has_counts_triggers</span></code> property revealing if a table has been configured with the new <code class="docutils literal notranslate"><span class="pre">_counts</span></code> database triggers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db.reset_counts()</span></code> method and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">reset-counts</span></code> command for resetting the values in the <code class="docutils literal notranslate"><span class="pre">_counts</span></code> table. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/219">#219</a>)</p></li>
<li><p>The previously undocumented <code class="docutils literal notranslate"><span class="pre">db.escape()</span></code> method has been renamed to <code class="docutils literal notranslate"><span class="pre">db.quote()</span></code> and is now covered by the documentation: <a class="reference internal" href="python-api.html#python-api-quote"><span class="std std-ref">Quoting strings for use in SQL</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/217">#217</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">table.triggers_dict</span></code> and <code class="docutils literal notranslate"><span class="pre">db.triggers_dict</span></code> introspection properties. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/211">#211</a>, <a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/216">#216</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span></code> now shows a more useful error message for invalid JSON. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/206">#206</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.1 (2021-01-01)"></a><section id="v3-1-1">
<span id="id43"></span><h2>3.1.1 (2021-01-01)<a class="headerlink" href="#v3-1-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Fixed failing test caused by <code class="docutils literal notranslate"><span class="pre">optimize</span></code> sometimes creating larger database files. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/209">#209</a>)</p></li>
<li><p>Documentation now lives on <a class="reference external" href="https://sqlite-utils.datasette.io/">https://sqlite-utils.datasette.io/</a></p></li>
<li><p>README now includes <code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">sqlite-utils</span></code> installation method.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.1 (2020-12-12)"></a><section id="v3-1">
<span id="id44"></span><h2>3.1 (2020-12-12)<a class="headerlink" href="#v3-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New command: <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">analyze-tables</span> <span class="pre">my.db</span></code> outputs useful information about the table columns in the database, such as the number of distinct values and how many rows are null. See <a class="reference internal" href="cli.html#cli-analyze-tables"><span class="std std-ref">Analyzing tables</span></a> for documentation. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/207">#207</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">table.analyze_column(column)</span></code> Python method used by the <code class="docutils literal notranslate"><span class="pre">analyze-tables</span></code> command - see <a class="reference internal" href="python-api.html#python-api-analyze-column"><span class="std std-ref">Analyzing a column</span></a>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">table.update()</span></code> method now correctly handles values that should be stored as JSON. Thanks, Andreas Madsack. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/pull/204">#204</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/3.0 (2020-11-08)"></a><section id="v3-0">
<span id="id45"></span><h2>3.0 (2020-11-08)<a class="headerlink" href="#v3-0" title="Link to this heading">#</a></h2>
<p>This release introduces a new <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">search</span></code> command for searching tables, see <a class="reference internal" href="cli.html#cli-search"><span class="std std-ref">Executing searches</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/192">#192</a>)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">table.search()</span></code> method has been redesigned, see <a class="reference internal" href="python-api.html#python-api-fts-search"><span class="std std-ref">Searching with table.search()</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/197">#197</a>)</p>
<p>The release includes minor backwards-incompatible changes, hence the version bump to 3.0. Those changes, which should not affect most users, are:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">-c</span></code> shortcut option for outputting CSV is no longer available. The full <code class="docutils literal notranslate"><span class="pre">--csv</span></code> option is required instead.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">-f</span></code> shortcut for <code class="docutils literal notranslate"><span class="pre">--fmt</span></code> has also been removed - use <code class="docutils literal notranslate"><span class="pre">--fmt</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">table.search()</span></code> method now defaults to sorting by relevance, not sorting by <code class="docutils literal notranslate"><span class="pre">rowid</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/198">#198</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">table.search()</span></code> method now returns a generator over a list of Python dictionaries. It previously returned a list of tuples.</p></li>
</ul>
<p>Also in this release:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">query</span></code>, <code class="docutils literal notranslate"><span class="pre">tables</span></code>, <code class="docutils literal notranslate"><span class="pre">rows</span></code> and <code class="docutils literal notranslate"><span class="pre">search</span></code> CLI commands now accept a new <code class="docutils literal notranslate"><span class="pre">--tsv</span></code> option which outputs the results in TSV. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/193">#193</a>)</p></li>
<li><p>A new <code class="docutils literal notranslate"><span class="pre">table.virtual_table_using</span></code> property reveals if a table is a virtual table, and returns the upper case type of virtual table (e.g. <code class="docutils literal notranslate"><span class="pre">FTS4</span></code> or <code class="docutils literal notranslate"><span class="pre">FTS5</span></code>) if it is. It returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the table is not a virtual table. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/196">#196</a>)</p></li>
<li><p>The new <code class="docutils literal notranslate"><span class="pre">table.search_sql()</span></code> method returns the SQL for searching a table, see <a class="reference internal" href="python-api.html#python-api-fts-search-sql"><span class="std std-ref">Building SQL queries with table.search_sql()</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">rows</span></code> now accepts multiple optional <code class="docutils literal notranslate"><span class="pre">-c</span></code> parameters specifying the columns to return. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/200">#200</a>)</p></li>
</ul>
<p>Changes since the 3.0a0 alpha release:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">search</span></code> command now defaults to returning every result, unless you add a <code class="docutils literal notranslate"><span class="pre">--limit</span> <span class="pre">20</span></code> option.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">search</span> <span class="pre">-c</span></code> and <code class="docutils literal notranslate"><span class="pre">table.search(columns=[])</span></code> options are now fully respected. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/201">#201</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.23 (2020-10-28)"></a><section id="v2-23">
<span id="id46"></span><h2>2.23 (2020-10-28)<a class="headerlink" href="#v2-23" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">table.m2m(other_table,</span> <span class="pre">records)</span></code> method now takes any iterable, not just a list or tuple. Thanks, Adam Wolf. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/pull/189">#189</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span></code> now displays a progress bar for CSV or TSV imports. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/173">#173</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">@db.register_function(deterministic=True)</span></code> option for registering deterministic SQLite functions in Python 3.8 or higher. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/191">#191</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.22 (2020-10-16)"></a><section id="v2-22">
<span id="id47"></span><h2>2.22 (2020-10-16)<a class="headerlink" href="#v2-22" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">--encoding</span></code> option for processing CSV and TSV files that use a non-utf-8 encoding, for both the <code class="docutils literal notranslate"><span class="pre">insert</span></code> and <code class="docutils literal notranslate"><span class="pre">update</span></code> commands. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/182">#182</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--load-extension</span></code> option is now available to many more commands. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/137">#137</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--load-extension=spatialite</span></code> can be used to load SpatiaLite from common installation locations, if it is available. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/136">#136</a>)</p></li>
<li><p>Tests now also run against Python 3.9. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/184">#184</a>)</p></li>
<li><p>Passing <code class="docutils literal notranslate"><span class="pre">pk=["id"]</span></code> now has the same effect as passing <code class="docutils literal notranslate"><span class="pre">pk="id"</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/181">#181</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.21 (2020-09-24)"></a><section id="v2-21">
<span id="id48"></span><h2>2.21 (2020-09-24)<a class="headerlink" href="#v2-21" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">table.extract()</span></code> and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">extract</span></code> now apply much, much faster - one example operation reduced from twelve minutes to just four seconds! (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/172">#172</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">extract</span></code> no longer shows a progress bar, because it’s fast enough not to need one.</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">column_order=</span></code> option for <code class="docutils literal notranslate"><span class="pre">table.transform()</span></code> which can be used to alter the order of columns in a table. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/175">#175</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">transform</span> <span class="pre">--column-order=</span></code> option (with a <code class="docutils literal notranslate"><span class="pre">-o</span></code> shortcut) for changing column order. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/176">#176</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">table.transform(drop_foreign_keys=)</span></code> parameter and the <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">transform</span> <span class="pre">--drop-foreign-key</span></code> option have changed. They now accept just the name of the column rather than requiring all three of the column, other table and other column. This is technically a backwards-incompatible change but I chose not to bump the major version number because the transform feature is so new. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/177">#177</a>)</p></li>
<li><p>The table <code class="docutils literal notranslate"><span class="pre">.disable_fts()</span></code>, <code class="docutils literal notranslate"><span class="pre">.rebuild_fts()</span></code>, <code class="docutils literal notranslate"><span class="pre">.delete()</span></code>, <code class="docutils literal notranslate"><span class="pre">.delete_where()</span></code> and <code class="docutils literal notranslate"><span class="pre">.add_missing_columns()</span></code> methods all now <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">self</span></code>, which means they can be chained together with other table operations.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.20 (2020-09-22)"></a><section id="v2-20">
<span id="id49"></span><h2>2.20 (2020-09-22)<a class="headerlink" href="#v2-20" title="Link to this heading">#</a></h2>
<p>This release introduces two key new capabilities: <strong>transform</strong> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/114">#114</a>) and <strong>extract</strong> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/42">#42</a>).</p>
<section id="transform">
<h3>Transform<a class="headerlink" href="#transform" title="Link to this heading">#</a></h3>
<p>SQLite’s ALTER TABLE has <a class="reference external" href="https://sqlite.org/lang_altertable.html">several documented limitations</a>. The <code class="docutils literal notranslate"><span class="pre">table.transform()</span></code> Python method and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">transform</span></code> CLI command work around these limitations using a pattern where a new table with the desired structure is created, data is copied over to it and the old table is then dropped and replaced by the new one.</p>
<p>You can use these tools to change column types, rename columns, drop columns, add and remove <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">NULL</span></code> and defaults, remove foreign key constraints and more. See the <a class="reference internal" href="cli.html#cli-transform-table"><span class="std std-ref">transforming tables (CLI)</span></a> and <a class="reference internal" href="python-api.html#python-api-transform"><span class="std std-ref">transforming tables (Python library)</span></a> documentation for full details of how to use them.</p>
</section>
<section id="extract">
<h3>Extract<a class="headerlink" href="#extract" title="Link to this heading">#</a></h3>
<p>Sometimes a database table - especially one imported from a CSV file - will contain duplicate data. A <code class="docutils literal notranslate"><span class="pre">Trees</span></code> table may include a <code class="docutils literal notranslate"><span class="pre">Species</span></code> column with only a few dozen unique values, when the table itself contains thousands of rows.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">table.extract()</span></code> method and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">extract</span></code> commands can extract a column - or multiple columns - out into a separate lookup table, and set up a foreign key relationship from the original table.</p>
<p>The Python library <a class="reference internal" href="python-api.html#python-api-extract"><span class="std std-ref">extract() documentation</span></a> describes how extraction works in detail, and <a class="reference internal" href="cli.html#cli-extract"><span class="std std-ref">Extracting columns into a separate table</span></a> in the CLI documentation includes a detailed example.</p>
</section>
<section id="id50">
<h3>Other changes<a class="headerlink" href="#id50" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">@db.register_function</span></code> decorator can be used to quickly register Python functions as custom SQL functions, see <a class="reference internal" href="python-api.html#python-api-register-function"><span class="std std-ref">Registering custom SQL functions</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/162">#162</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">table.rows_where()</span></code> method now accepts an optional <code class="docutils literal notranslate"><span class="pre">select=</span></code> argument for specifying which columns should be selected, see <a class="reference internal" href="python-api.html#python-api-rows"><span class="std std-ref">Listing rows</span></a>.</p></li>
</ul>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.19 (2020-09-20)"></a><section id="v2-19">
<span id="id51"></span><h2>2.19 (2020-09-20)<a class="headerlink" href="#v2-19" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">add-foreign-keys</span></code> command for <a class="reference internal" href="cli.html#cli-add-foreign-keys"><span class="std std-ref">Adding multiple foreign keys at once</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/157">#157</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">table.enable_fts(...,</span> <span class="pre">replace=True)</span></code> argument for replacing an existing FTS table with a new configuration. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/160">#160</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">table.add_foreign_key(...,</span> <span class="pre">ignore=True)</span></code> argument for ignoring a foreign key if it already exists. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/112">#112</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.18 (2020-09-08)"></a><section id="v2-18">
<span id="id52"></span><h2>2.18 (2020-09-08)<a class="headerlink" href="#v2-18" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">table.rebuild_fts()</span></code> method for rebuilding a FTS index, see <a class="reference internal" href="python-api.html#python-api-fts-rebuild"><span class="std std-ref">Rebuilding a full-text search table</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/155">#155</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">rebuild-fts</span> <span class="pre">data.db</span></code> command for rebuilding FTS indexes across all tables, or just specific tables. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/155">#155</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.optimize()</span></code> method no longer deletes junk rows from the <code class="docutils literal notranslate"><span class="pre">*_fts_docsize</span></code> table. This was added in 2.17 but it turns out running <code class="docutils literal notranslate"><span class="pre">table.rebuild_fts()</span></code> is a better solution to this problem.</p></li>
<li><p>Fixed a bug where rows with additional columns that are inserted after the first batch of records could cause an error due to breaking SQLite’s maximum number of parameters. Thanks, Simon Wiles. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/145">#145</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.17 (2020-09-07)"></a><section id="v2-17">
<span id="id53"></span><h2>2.17 (2020-09-07)<a class="headerlink" href="#v2-17" title="Link to this heading">#</a></h2>
<p>This release handles a bug where replacing rows in FTS tables could result in growing numbers of unnecessary rows in the associated <code class="docutils literal notranslate"><span class="pre">*_fts_docsize</span></code> table. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/149">#149</a>)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PRAGMA</span> <span class="pre">recursive_triggers=on</span></code> by default for all connections. You can turn it off with <code class="docutils literal notranslate"><span class="pre">Database(recursive_triggers=False)</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/152">#152</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.optimize()</span></code> method now deletes unnecessary rows from the <code class="docutils literal notranslate"><span class="pre">*_fts_docsize</span></code> table. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/153">#153</a>)</p></li>
<li><p>New tracer method for tracking underlying SQL queries, see <a class="reference internal" href="python-api.html#python-api-tracing"><span class="std std-ref">Tracing queries</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/150">#150</a>)</p></li>
<li><p>Neater indentation for schema SQL. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/148">#148</a>)</p></li>
<li><p>Documentation for <code class="docutils literal notranslate"><span class="pre">sqlite_utils.AlterError</span></code> exception thrown by in <code class="docutils literal notranslate"><span class="pre">add_foreign_keys()</span></code>.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.16.1 (2020-08-28)"></a><section id="v2-16-1">
<span id="id54"></span><h2>2.16.1 (2020-08-28)<a class="headerlink" href="#v2-16-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">insert_all(...,</span> <span class="pre">alter=True)</span></code> now works for columns introduced after the first 100 records. Thanks, Simon Wiles! (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/139">#139</a>)</p></li>
<li><p>Continuous Integration is now powered by GitHub Actions. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/143">#143</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.16 (2020-08-21)"></a><section id="v2-16">
<span id="id55"></span><h2>2.16 (2020-08-21)<a class="headerlink" href="#v2-16" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--load-extension</span></code> option for <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">query</span></code> for loading SQLite extensions. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/134">#134</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite_utils.utils.find_spatialite()</span></code> function for finding SpatiaLite in common locations. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/135">#135</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.15.1 (2020-08-12)"></a><section id="v2-15-1">
<span id="id56"></span><h2>2.15.1 (2020-08-12)<a class="headerlink" href="#v2-15-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Now available as a <code class="docutils literal notranslate"><span class="pre">sdist</span></code> package on PyPI in addition to a wheel. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/133">#133</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.15 (2020-08-10)"></a><section id="v2-15">
<span id="id57"></span><h2>2.15 (2020-08-10)<a class="headerlink" href="#v2-15" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">db.enable_wal()</span></code> and <code class="docutils literal notranslate"><span class="pre">db.disable_wal()</span></code> methods for enabling and disabling <a class="reference external" href="https://www.sqlite.org/wal.html">Write-Ahead Logging</a> for a database file - see <a class="reference internal" href="python-api.html#python-api-wal"><span class="std std-ref">WAL mode</span></a> in the Python API documentation.</p></li>
<li><p>Also <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">enable-wal</span> <span class="pre">file.db</span></code> and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">disable-wal</span> <span class="pre">file.db</span></code> commands for doing the same thing on the command-line, see <a class="reference internal" href="cli.html#cli-wal"><span class="std std-ref">WAL mode (CLI)</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/132">#132</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.14.1 (2020-08-05)"></a><section id="v2-14-1">
<span id="id58"></span><h2>2.14.1 (2020-08-05)<a class="headerlink" href="#v2-14-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Documentation improvements.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.14 (2020-08-01)"></a><section id="v2-14">
<span id="id59"></span><h2>2.14 (2020-08-01)<a class="headerlink" href="#v2-14" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The <a class="reference internal" href="cli.html#cli-insert-files"><span class="std std-ref">insert-files command</span></a> can now read from standard input: <code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">dog.jpg</span> <span class="pre">|</span> <span class="pre">sqlite-utils</span> <span class="pre">insert-files</span> <span class="pre">dogs.db</span> <span class="pre">pics</span> <span class="pre">-</span> <span class="pre">--name=dog.jpg</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/127">#127</a>)</p></li>
<li><p>You can now specify a full-text search tokenizer using the new <code class="docutils literal notranslate"><span class="pre">tokenize=</span></code> parameter to <a class="reference internal" href="python-api.html#python-api-fts"><span class="std std-ref">enable_fts()</span></a>. This means you can enable Porter stemming on a table by running <code class="docutils literal notranslate"><span class="pre">db["articles"].enable_fts(["headline",</span> <span class="pre">"body"],</span> <span class="pre">tokenize="porter")</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/130">#130</a>)</p></li>
<li><p>You can also set a custom tokenizer using the <a class="reference internal" href="cli.html#cli-fts"><span class="std std-ref">sqlite-utils enable-fts</span></a> CLI command, via the new <code class="docutils literal notranslate"><span class="pre">--tokenize</span></code> option.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.13 (2020-07-29)"></a><section id="v2-13">
<span id="id60"></span><h2>2.13 (2020-07-29)<a class="headerlink" href="#v2-13" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">memoryview</span></code> and <code class="docutils literal notranslate"><span class="pre">uuid.UUID</span></code> objects are now supported. <code class="docutils literal notranslate"><span class="pre">memoryview</span></code> objects will be stored using <code class="docutils literal notranslate"><span class="pre">BLOB</span></code> and <code class="docutils literal notranslate"><span class="pre">uuid.UUID</span></code> objects will be stored using <code class="docutils literal notranslate"><span class="pre">TEXT</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/128">#128</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.12 (2020-07-27)"></a><section id="v2-12">
<span id="id61"></span><h2>2.12 (2020-07-27)<a class="headerlink" href="#v2-12" title="Link to this heading">#</a></h2>
<p>The theme of this release is better tools for working with binary data. The new <code class="docutils literal notranslate"><span class="pre">insert-files</span></code> command can be used to insert binary files directly into a database table, and other commands have been improved with better support for BLOB columns.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert-files</span> <span class="pre">my.db</span> <span class="pre">gifs</span> <span class="pre">*.gif</span></code> can now insert the contents of files into a specified table. The columns in the table can be customized to include different pieces of metadata derived from the files. See <a class="reference internal" href="cli.html#cli-insert-files"><span class="std std-ref">Inserting data from files</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/122">#122</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--raw</span></code> option to <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">query</span></code> - for outputting just a single raw column value - see <a class="reference internal" href="cli.html#cli-query-raw"><span class="std std-ref">Returning raw data, such as binary content</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/123">#123</a>)</p></li>
<li><p>JSON output now encodes BLOB values as special base64 objects - see <a class="reference internal" href="cli.html#cli-query-json"><span class="std std-ref">Returning JSON</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/125">#125</a>)</p></li>
<li><p>The same format of JSON base64 objects can now be used to insert binary data - see <a class="reference internal" href="cli.html#cli-inserting-data"><span class="std std-ref">Inserting JSON data</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/126">#126</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">query</span></code> command can now accept named parameters, e.g. <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">:memory:</span> <span class="pre">"select</span> <span class="pre">:num</span> <span class="pre">*</span> <span class="pre">:num2"</span> <span class="pre">-p</span> <span class="pre">num</span> <span class="pre">5</span> <span class="pre">-p</span> <span class="pre">num2</span> <span class="pre">6</span></code> - see <a class="reference internal" href="cli.html#cli-query-json"><span class="std std-ref">Returning JSON</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/124">#124</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.11 (2020-07-08)"></a><section id="v2-11">
<span id="id62"></span><h2>2.11 (2020-07-08)<a class="headerlink" href="#v2-11" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">--truncate</span></code> option to <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span></code>, and <code class="docutils literal notranslate"><span class="pre">truncate=True</span></code> argument to <code class="docutils literal notranslate"><span class="pre">.insert_all()</span></code>. Thanks, Thomas Sibley. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/pull/118">#118</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">query</span></code> command now runs updates in a transaction. Thanks, Thomas Sibley. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/pull/120">#120</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.10.1 (2020-06-23)"></a><section id="v2-10-1">
<span id="id63"></span><h2>2.10.1 (2020-06-23)<a class="headerlink" href="#v2-10-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Added documentation for the <code class="docutils literal notranslate"><span class="pre">table.pks</span></code> introspection property. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/116">#116</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.10 (2020-06-12)"></a><section id="v2-10">
<span id="id64"></span><h2>2.10 (2020-06-12)<a class="headerlink" href="#v2-10" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span></code> command now supports UPDATE/INSERT/DELETE in addition to SELECT. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/115">#115</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.9.1 (2020-05-11)"></a><section id="v2-9-1">
<span id="id65"></span><h2>2.9.1 (2020-05-11)<a class="headerlink" href="#v2-9-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Added custom project links to the <a class="reference external" href="https://pypi.org/project/sqlite-utils/">PyPI listing</a>.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.9 (2020-05-10)"></a><section id="v2-9">
<span id="id66"></span><h2>2.9 (2020-05-10)<a class="headerlink" href="#v2-9" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">drop-table</span></code> command, see <a class="reference internal" href="cli.html#cli-drop-table"><span class="std std-ref">Dropping tables</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/111">#111</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">drop-view</span></code> command, see <a class="reference internal" href="cli.html#cli-drop-view"><span class="std std-ref">Dropping views</span></a>.</p></li>
<li><p>Python <code class="docutils literal notranslate"><span class="pre">decimal.Decimal</span></code> objects are now stored as <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/110">#110</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.8 (2020-05-03)"></a><section id="v2-8">
<span id="id67"></span><h2>2.8 (2020-05-03)<a class="headerlink" href="#v2-8" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">create-table</span></code> command, see <a class="reference internal" href="cli.html#cli-create-table"><span class="std std-ref">Creating tables</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/27">#27</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">create-view</span></code> command, see <a class="reference internal" href="cli.html#cli-create-view"><span class="std std-ref">Creating views</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/107">#107</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.7.2 (2020-05-02)"></a><section id="v2-7-2">
<span id="id68"></span><h2>2.7.2 (2020-05-02)<a class="headerlink" href="#v2-7-2" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">db.create_view(...)</span></code> now has additional parameters <code class="docutils literal notranslate"><span class="pre">ignore=True</span></code> or <code class="docutils literal notranslate"><span class="pre">replace=True</span></code>, see <a class="reference internal" href="python-api.html#python-api-create-view"><span class="std std-ref">Creating views</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/106">#106</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.7.1 (2020-05-01)"></a><section id="v2-7-1">
<span id="id69"></span><h2>2.7.1 (2020-05-01)<a class="headerlink" href="#v2-7-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">views</span> <span class="pre">my.db</span></code> command for listing views in a database, see <a class="reference internal" href="cli.html#cli-views"><span class="std std-ref">Listing views</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/105">#105</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">tables</span></code> (and <code class="docutils literal notranslate"><span class="pre">views</span></code>) has a new <code class="docutils literal notranslate"><span class="pre">--schema</span></code> option which outputs the table/view schema, see <a class="reference internal" href="cli.html#cli-tables"><span class="std std-ref">Listing tables</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/104">#104</a>)</p></li>
<li><p>Nested structures containing invalid JSON values (e.g. Python bytestrings) are now serialized using <code class="docutils literal notranslate"><span class="pre">repr()</span></code> instead of throwing an error. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/102">#102</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.7 (2020-04-17)"></a><section id="v2-7">
<span id="id70"></span><h2>2.7 (2020-04-17)<a class="headerlink" href="#v2-7" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">columns=</span></code> argument for the <code class="docutils literal notranslate"><span class="pre">.insert()</span></code>, <code class="docutils literal notranslate"><span class="pre">.insert_all()</span></code>, <code class="docutils literal notranslate"><span class="pre">.upsert()</span></code> and <code class="docutils literal notranslate"><span class="pre">.upsert_all()</span></code> methods, for over-riding the auto-detected types for columns and specifying additional columns that should be added when the table is created. See <a class="reference internal" href="python-api.html#python-api-custom-columns"><span class="std std-ref">Custom column order and column types</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/100">#100</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.6 (2020-04-15)"></a><section id="v2-6">
<span id="id71"></span><h2>2.6 (2020-04-15)<a class="headerlink" href="#v2-6" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">table.rows_where(...,</span> <span class="pre">order_by="age</span> <span class="pre">desc")</span></code> argument, see <a class="reference internal" href="python-api.html#python-api-rows"><span class="std std-ref">Listing rows</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/76">#76</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.5 (2020-04-12)"></a><section id="v2-5">
<span id="id72"></span><h2>2.5 (2020-04-12)<a class="headerlink" href="#v2-5" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Panda’s Timestamp is now stored as a SQLite TEXT column. Thanks, b0b5h4rp13! (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/96">#96</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.last_pk</span></code> is now only available for inserts or upserts of a single record. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/98">#98</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">Database(filepath,</span> <span class="pre">recreate=True)</span></code> parameter for deleting and recreating the database. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/97">#97</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.4.4 (2020-03-23)"></a><section id="v2-4-4">
<span id="id73"></span><h2>2.4.4 (2020-03-23)<a class="headerlink" href="#v2-4-4" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Fixed bug where columns with only null values were not correctly created. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/95">#95</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.4.3 (2020-03-23)"></a><section id="v2-4-3">
<span id="id74"></span><h2>2.4.3 (2020-03-23)<a class="headerlink" href="#v2-4-3" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Column type suggestion code is no longer confused by null values. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/94">#94</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.4.2 (2020-03-14)"></a><section id="v2-4-2">
<span id="id75"></span><h2>2.4.2 (2020-03-14)<a class="headerlink" href="#v2-4-2" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">table.column_dicts</span></code> now works with all column types - previously it would throw errors on types other than <code class="docutils literal notranslate"><span class="pre">TEXT</span></code>, <code class="docutils literal notranslate"><span class="pre">BLOB</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code> or <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/92">#92</a>)</p></li>
<li><p>Documentation for <code class="docutils literal notranslate"><span class="pre">NotFoundError</span></code> thrown by <code class="docutils literal notranslate"><span class="pre">table.get(pk)</span></code> - see <a class="reference internal" href="python-api.html#python-api-get"><span class="std std-ref">Retrieving a specific record</span></a>.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.4.1 (2020-03-01)"></a><section id="v2-4-1">
<span id="id76"></span><h2>2.4.1 (2020-03-01)<a class="headerlink" href="#v2-4-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">table.enable_fts()</span></code> now works with columns that contain spaces. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/90">#90</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.4 (2020-02-26)"></a><section id="v2-4">
<span id="id77"></span><h2>2.4 (2020-02-26)<a class="headerlink" href="#v2-4" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">table.disable_fts()</span></code> can now be used to remove FTS tables and triggers that were created using <code class="docutils literal notranslate"><span class="pre">table.enable_fts(...)</span></code>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/88">#88</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">disable-fts</span></code> command can be used to remove FTS tables and triggers from the command-line. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/88">#88</a>)</p></li>
<li><p>Trying to create table columns with square braces ([ or ]) in the name now raises an error. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/86">#86</a>)</p></li>
<li><p>Subclasses of <code class="docutils literal notranslate"><span class="pre">dict</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">tuple</span></code> are now detected as needing a JSON column. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/87">#87</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.3.1 (2020-02-10)"></a><section id="v2-3-1">
<span id="id78"></span><h2>2.3.1 (2020-02-10)<a class="headerlink" href="#v2-3-1" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">table.create_index()</span></code> now works for columns that contain spaces. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/85">#85</a>)</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.3 (2020-02-08)"></a><section id="v2-3">
<span id="id79"></span><h2>2.3 (2020-02-08)<a class="headerlink" href="#v2-3" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">table.exists()</span></code> is now a method, not a property. This was not a documented part of the API before so I’m considering this a non-breaking change. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/83">#83</a>)</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.2.1 (2020-02-06)"></a><section id="v2-2-1">
<span id="id80"></span><h2>2.2.1 (2020-02-06)<a class="headerlink" href="#v2-2-1" title="Link to this heading">#</a></h2>
<p>Fixed a bug where <code class="docutils literal notranslate"><span class="pre">.upsert(...,</span> <span class="pre">hash_id="pk")</span></code> threw an error (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/84">#84</a>).</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.2 (2020-02-01)"></a><section id="v2-2">
<span id="id81"></span><h2>2.2 (2020-02-01)<a class="headerlink" href="#v2-2" title="Link to this heading">#</a></h2>
<p>New feature: <code class="docutils literal notranslate"><span class="pre">sqlite_utils.suggest_column_types([records])</span></code> returns the suggested column types for a list of records. See <a class="reference internal" href="python-api.html#python-api-suggest-column-types"><span class="std std-ref">Suggesting column types</span></a>. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/81">#81</a>).</p>
<p>This replaces the undocumented <code class="docutils literal notranslate"><span class="pre">table.detect_column_types()</span></code> method.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.1 (2020-01-30)"></a><section id="v2-1">
<span id="id82"></span><h2>2.1 (2020-01-30)<a class="headerlink" href="#v2-1" title="Link to this heading">#</a></h2>
<p>New feature: <code class="docutils literal notranslate"><span class="pre">conversions={...}</span></code> can be passed to the <code class="docutils literal notranslate"><span class="pre">.insert()</span></code> family of functions to specify SQL conversions that should be applied to values that are being inserted or updated. See <a class="reference internal" href="python-api.html#python-api-conversions"><span class="std std-ref">Converting column values using SQL functions</span></a> . (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/73">#77</a>).</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.0.1 (2020-01-05)"></a><section id="v2-0-1">
<span id="id83"></span><h2>2.0.1 (2020-01-05)<a class="headerlink" href="#v2-0-1" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">.upsert()</span></code> and <code class="docutils literal notranslate"><span class="pre">.upsert_all()</span></code> methods now raise a <code class="docutils literal notranslate"><span class="pre">sqlite_utils.db.PrimaryKeyRequired</span></code> exception if you call them without specifying the primary key column using <code class="docutils literal notranslate"><span class="pre">pk=</span></code> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/73">#73</a>).</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/2.0 (2019-12-29)"></a><section id="v2">
<span id="id84"></span><h2>2.0 (2019-12-29)<a class="headerlink" href="#v2" title="Link to this heading">#</a></h2>
<p>This release changes the behaviour of <code class="docutils literal notranslate"><span class="pre">upsert</span></code>. It’s a breaking change, hence <code class="docutils literal notranslate"><span class="pre">2.0</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">upsert</span></code> command-line utility and the <code class="docutils literal notranslate"><span class="pre">.upsert()</span></code> and <code class="docutils literal notranslate"><span class="pre">.upsert_all()</span></code> Python API methods have had their behaviour altered. They used to completely replace the affected records: now, they update the specified values on existing records but leave other columns unaffected.</p>
<p>See <a class="reference internal" href="python-api.html#python-api-upsert"><span class="std std-ref">Upserting data using the Python API</span></a> and <a class="reference internal" href="cli.html#cli-upsert"><span class="std std-ref">Upserting data using the CLI</span></a> for full details.</p>
<p>If you want the old behaviour - where records were completely replaced - you can use <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">sqlite-utils</span> <span class="pre">insert</span> <span class="pre">...</span> <span class="pre">--replace</span></code> on the command-line and <code class="docutils literal notranslate"><span class="pre">.insert(...,</span> <span class="pre">replace=True)</span></code> and <code class="docutils literal notranslate"><span class="pre">.insert_all(...,</span> <span class="pre">replace=True)</span></code> in the Python API. See <a class="reference internal" href="python-api.html#python-api-insert-replace"><span class="std std-ref">Insert-replacing data using the Python API</span></a> and <a class="reference internal" href="cli.html#cli-insert-replace"><span class="std std-ref">Insert-replacing data using the CLI</span></a> for more.</p>
<p>For full background on this change, see <a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/66">issue #66</a>.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.12.1 (2019-11-06)"></a><section id="v1-12-1">
<span id="id85"></span><h2>1.12.1 (2019-11-06)<a class="headerlink" href="#v1-12-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Fixed error thrown when <code class="docutils literal notranslate"><span class="pre">.insert_all()</span></code> and <code class="docutils literal notranslate"><span class="pre">.upsert_all()</span></code> were called with empty lists (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/52">#52</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.12 (2019-11-04)"></a><section id="v1-12">
<span id="id86"></span><h2>1.12 (2019-11-04)<a class="headerlink" href="#v1-12" title="Link to this heading">#</a></h2>
<p>Python library utilities for deleting records (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/62">#62</a>)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">db["tablename"].delete(4)</span></code> to delete by primary key, see <a class="reference internal" href="python-api.html#python-api-delete"><span class="std std-ref">Deleting a specific record</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db["tablename"].delete_where("id</span> <span class="pre">&gt;</span> <span class="pre">?",</span> <span class="pre">[3])</span></code> to delete by a where clause, see <a class="reference internal" href="python-api.html#python-api-delete-where"><span class="std std-ref">Deleting multiple records</span></a></p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.11 (2019-09-02)"></a><section id="v1-11">
<span id="id87"></span><h2>1.11 (2019-09-02)<a class="headerlink" href="#v1-11" title="Link to this heading">#</a></h2>
<p>Option to create triggers to automatically keep FTS tables up-to-date with newly inserted, updated and deleted records. Thanks, Amjith Ramanujam! (<a class="reference external" href="https://github.com/simonw/sqlite-utils/pull/57">#57</a>)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">enable-fts</span> <span class="pre">...</span> <span class="pre">--create-triggers</span></code> - see <a class="reference internal" href="cli.html#cli-fts"><span class="std std-ref">Configuring full-text search using the CLI</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db["tablename"].enable_fts(...,</span> <span class="pre">create_triggers=True)</span></code> - see <a class="reference internal" href="python-api.html#python-api-fts"><span class="std std-ref">Configuring full-text search using the Python library</span></a></p></li>
<li><p>Support for introspecting triggers for a database or table - see <a class="reference internal" href="python-api.html#python-api-introspection"><span class="std std-ref">Introspecting tables and views</span></a> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/59">#59</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.10 (2019-08-23)"></a><section id="v1-10">
<span id="id88"></span><h2>1.10 (2019-08-23)<a class="headerlink" href="#v1-10" title="Link to this heading">#</a></h2>
<p>Ability to introspect and run queries against views (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/54">#54</a>)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">db.view_names()</span></code> method and and <code class="docutils literal notranslate"><span class="pre">db.views</span></code> property</p></li>
<li><p>Separate <code class="docutils literal notranslate"><span class="pre">View</span></code> and <code class="docutils literal notranslate"><span class="pre">Table</span></code> classes, both subclassing new <code class="docutils literal notranslate"><span class="pre">Queryable</span></code> class</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">view.drop()</span></code> method</p></li>
</ul>
<p>See <a class="reference internal" href="python-api.html#python-api-views"><span class="std std-ref">Listing views</span></a>.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.9 (2019-08-04)"></a><section id="v1-9">
<span id="id89"></span><h2>1.9 (2019-08-04)<a class="headerlink" href="#v1-9" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">table.m2m(...)</span></code> method for creating many-to-many relationships: <a class="reference internal" href="python-api.html#python-api-m2m"><span class="std std-ref">Working with many-to-many relationships</span></a> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/23">#23</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.8 (2019-07-28)"></a><section id="v1-8">
<span id="id90"></span><h2>1.8 (2019-07-28)<a class="headerlink" href="#v1-8" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">table.update(pk,</span> <span class="pre">values)</span></code> method: <a class="reference internal" href="python-api.html#python-api-update"><span class="std std-ref">Updating a specific record</span></a> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/35">#35</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.7.1 (2019-07-28)"></a><section id="v1-7-1">
<span id="id91"></span><h2>1.7.1 (2019-07-28)<a class="headerlink" href="#v1-7-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Fixed bug where inserting records with 11 columns in a batch of 100 triggered a “too many SQL variables” error (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/50">#50</a>)</p></li>
<li><p>Documentation and tests for <code class="docutils literal notranslate"><span class="pre">table.drop()</span></code> method: <a class="reference internal" href="python-api.html#python-api-drop"><span class="std std-ref">Dropping a table or view</span></a></p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.7 (2019-07-24)"></a><section id="v1-7">
<span id="id92"></span><h2>1.7 (2019-07-24)<a class="headerlink" href="#v1-7" title="Link to this heading">#</a></h2>
<p>Support for lookup tables.</p>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">table.lookup({...})</span></code> utility method for building and querying lookup tables - see <a class="reference internal" href="python-api.html#python-api-lookup-tables"><span class="std std-ref">Working with lookup tables</span></a> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/44">#44</a>)</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">extracts=</span></code> table configuration option, see <a class="reference internal" href="python-api.html#python-api-extracts"><span class="std std-ref">Populating lookup tables automatically during insert/upsert</span></a> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/46">#46</a>)</p></li>
<li><p>Use <a class="reference external" href="https://github.com/coleifer/pysqlite3">pysqlite3</a> if it is available, otherwise use <code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> from the standard library</p></li>
<li><p>Table options can now be passed to the new <code class="docutils literal notranslate"><span class="pre">db.table(name,</span> <span class="pre">**options)</span></code> factory function in addition to being passed to <code class="docutils literal notranslate"><span class="pre">insert_all(records,</span> <span class="pre">**options)</span></code> and friends - see <a class="reference internal" href="python-api.html#python-api-table-configuration"><span class="std std-ref">Table configuration options</span></a></p></li>
<li><p>In-memory databases can now be created using <code class="docutils literal notranslate"><span class="pre">db</span> <span class="pre">=</span> <span class="pre">Database(memory=True)</span></code></p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.6 (2019-07-18)"></a><section id="v1-6">
<span id="id93"></span><h2>1.6 (2019-07-18)<a class="headerlink" href="#v1-6" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span></code> can now accept TSV data via the new <code class="docutils literal notranslate"><span class="pre">--tsv</span></code> option (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/41">#41</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.5 (2019-07-14)"></a><section id="v1-5">
<span id="id94"></span><h2>1.5 (2019-07-14)<a class="headerlink" href="#v1-5" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Support for compound primary keys (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/36">#36</a>)</p>
<ul>
<li><p>Configure these using the CLI tool by passing <code class="docutils literal notranslate"><span class="pre">--pk</span></code> multiple times</p></li>
<li><p>In Python, pass a tuple of columns to the <code class="docutils literal notranslate"><span class="pre">pk=(...,</span> <span class="pre">...)</span></code> argument: <a class="reference internal" href="python-api.html#python-api-compound-primary-keys"><span class="std std-ref">Compound primary keys</span></a></p></li>
</ul>
</li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">table.get()</span></code> method for retrieving a record by its primary key: <a class="reference internal" href="python-api.html#python-api-get"><span class="std std-ref">Retrieving a specific record</span></a> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/39">#39</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.4.1 (2019-07-14)"></a><section id="v1-4-1">
<span id="id95"></span><h2>1.4.1 (2019-07-14)<a class="headerlink" href="#v1-4-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Assorted minor documentation fixes: <a class="reference external" href="https://github.com/simonw/sqlite-utils/compare/1.4...1.4.1">changes since 1.4</a></p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.4 (2019-06-30)"></a><section id="v1-4">
<span id="id96"></span><h2>1.4 (2019-06-30)<a class="headerlink" href="#v1-4" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Added <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">index-foreign-keys</span></code> command (<a class="reference internal" href="cli.html#cli-index-foreign-keys"><span class="std std-ref">docs</span></a>) and <code class="docutils literal notranslate"><span class="pre">db.index_foreign_keys()</span></code> method (<a class="reference internal" href="python-api.html#python-api-index-foreign-keys"><span class="std std-ref">docs</span></a>) (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/33">#33</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.3 (2019-06-28)"></a><section id="v1-3">
<span id="id97"></span><h2>1.3 (2019-06-28)<a class="headerlink" href="#v1-3" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New mechanism for adding multiple foreign key constraints at once: <a class="reference internal" href="python-api.html#python-api-add-foreign-keys"><span class="std std-ref">db.add_foreign_keys() documentation</span></a> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/31">#31</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.2.2 (2019-06-25)"></a><section id="v1-2-2">
<span id="id98"></span><h2>1.2.2 (2019-06-25)<a class="headerlink" href="#v1-2-2" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Fixed bug where <code class="docutils literal notranslate"><span class="pre">datetime.time</span></code> was not being handled correctly</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.2.1 (2019-06-20)"></a><section id="v1-2-1">
<span id="id99"></span><h2>1.2.1 (2019-06-20)<a class="headerlink" href="#v1-2-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Check the column exists before attempting to add a foreign key (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/29">#29</a>)</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.2 (2019-06-12)"></a><section id="v1-2">
<span id="id100"></span><h2>1.2 (2019-06-12)<a class="headerlink" href="#v1-2" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Improved foreign key definitions: you no longer need to specify the <code class="docutils literal notranslate"><span class="pre">column</span></code>, <code class="docutils literal notranslate"><span class="pre">other_table</span></code> AND <code class="docutils literal notranslate"><span class="pre">other_column</span></code> to define a foreign key - if you omit the <code class="docutils literal notranslate"><span class="pre">other_table</span></code> or <code class="docutils literal notranslate"><span class="pre">other_column</span></code> the script will attempt to guess the correct values by introspecting the database. See <a class="reference internal" href="python-api.html#python-api-add-foreign-key"><span class="std std-ref">Adding foreign key constraints</span></a> for details. (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/25">#25</a>)</p></li>
<li><p>Ability to set <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">NULL</span></code> constraints and <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> values when creating tables (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/24">#24</a>). Documentation: <a class="reference internal" href="python-api.html#python-api-defaults-not-null"><span class="std std-ref">Setting defaults and not null constraints (Python API)</span></a>, <a class="reference internal" href="cli.html#cli-defaults-not-null"><span class="std std-ref">Setting defaults and not null constraints (CLI)</span></a></p></li>
<li><p>Support for <code class="docutils literal notranslate"><span class="pre">not_null_default=X</span></code> / <code class="docutils literal notranslate"><span class="pre">--not-null-default</span></code> for setting a <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">NULL</span> <span class="pre">DEFAULT</span> <span class="pre">'x'</span></code> when adding a new column. Documentation: <a class="reference internal" href="python-api.html#python-api-add-column"><span class="std std-ref">Adding columns (Python API)</span></a>, <a class="reference internal" href="cli.html#cli-add-column"><span class="std std-ref">Adding columns (CLI)</span></a></p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.1 (2019-05-28)"></a><section id="v1-1">
<span id="id101"></span><h2>1.1 (2019-05-28)<a class="headerlink" href="#v1-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Support for <code class="docutils literal notranslate"><span class="pre">ignore=True</span></code> / <code class="docutils literal notranslate"><span class="pre">--ignore</span></code> for ignoring inserted records if the primary key already exists (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/21">#21</a>) - documentation: <a class="reference internal" href="python-api.html#python-api-bulk-inserts"><span class="std std-ref">Inserting data (Python API)</span></a>, <a class="reference internal" href="cli.html#cli-inserting-data"><span class="std std-ref">Inserting data (CLI)</span></a></p></li>
<li><p>Ability to add a column that is a foreign key reference using <code class="docutils literal notranslate"><span class="pre">fk=...</span></code> / <code class="docutils literal notranslate"><span class="pre">--fk</span></code> (<a class="reference external" href="https://github.com/simonw/sqlite-utils/issues/16">#16</a>) - documentation: <a class="reference internal" href="python-api.html#python-api-add-column"><span class="std std-ref">Adding columns (Python API)</span></a>, <a class="reference internal" href="cli.html#cli-add-column"><span class="std std-ref">Adding columns (CLI)</span></a></p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.0.1 (2019-05-27)"></a><section id="v1-0-1">
<span id="id102"></span><h2>1.0.1 (2019-05-27)<a class="headerlink" href="#v1-0-1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">rows</span> <span class="pre">data.db</span> <span class="pre">table</span> <span class="pre">--json-cols</span></code> - fixed bug where <code class="docutils literal notranslate"><span class="pre">--json-cols</span></code> was not obeyed</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/1.0 (2019-05-24)"></a><section id="v1-0">
<span id="id103"></span><h2>1.0 (2019-05-24)<a class="headerlink" href="#v1-0" title="Link to this heading">#</a></h2>
<ul>
<li><dl>
<dt>Option to automatically add new columns if you attempt to insert or upsert data with extra fields:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span> <span class="pre">...</span> <span class="pre">--alter</span></code> - see <a class="reference internal" href="cli.html#cli-add-column-alter"><span class="std std-ref">Adding columns automatically with the sqlite-utils CLI</span></a></p>
<p><code class="docutils literal notranslate"><span class="pre">db["tablename"].insert(record,</span> <span class="pre">alter=True)</span></code> - see <a class="reference internal" href="python-api.html#python-api-add-column-alter"><span class="std std-ref">Adding columns automatically using the Python API</span></a></p>
</dd>
</dl>
</li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">--json-cols</span></code> option for outputting nested JSON, see <a class="reference internal" href="cli.html#cli-json-values"><span class="std std-ref">Nested JSON values</span></a></p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/0.14 (2019-02-24)"></a><section id="v0-14">
<span id="id104"></span><h2>0.14 (2019-02-24)<a class="headerlink" href="#v0-14" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Ability to create unique indexes: <code class="docutils literal notranslate"><span class="pre">db["mytable"].create_index(["name"],</span> <span class="pre">unique=True)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db["mytable"].create_index(["name"],</span> <span class="pre">if_not_exists=True)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">sqlite-utils</span> <span class="pre">create-index</span> <span class="pre">mydb.db</span> <span class="pre">mytable</span> <span class="pre">col1</span> <span class="pre">[col2...]</span></code>, see <a class="reference internal" href="cli.html#cli-create-index"><span class="std std-ref">Creating indexes</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.add_column(name,</span> <span class="pre">type)</span></code> method, see <a class="reference internal" href="python-api.html#python-api-add-column"><span class="std std-ref">Adding columns</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">sqlite-utils</span> <span class="pre">add-column</span> <span class="pre">mydb.db</span> <span class="pre">mytable</span> <span class="pre">nameofcolumn</span></code>, see <a class="reference internal" href="cli.html#cli-add-column"><span class="std std-ref">Adding columns</span></a> (CLI)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db["books"].add_foreign_key("author_id",</span> <span class="pre">"authors",</span> <span class="pre">"id")</span></code>, see <a class="reference internal" href="python-api.html#python-api-add-foreign-key"><span class="std std-ref">Adding foreign key constraints</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">sqlite-utils</span> <span class="pre">add-foreign-key</span> <span class="pre">books.db</span> <span class="pre">books</span> <span class="pre">author_id</span> <span class="pre">authors</span> <span class="pre">id</span></code>, see <a class="reference internal" href="cli.html#cli-add-foreign-key"><span class="std std-ref">Adding foreign key constraints</span></a> (CLI)</p></li>
<li><p>Improved (but backwards-incompatible) <code class="docutils literal notranslate"><span class="pre">foreign_keys=</span></code> argument to various methods, see <a class="reference internal" href="python-api.html#python-api-foreign-keys"><span class="std std-ref">Specifying foreign keys</span></a></p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/0.13 (2019-02-23)"></a><section id="v0-13">
<span id="id105"></span><h2>0.13 (2019-02-23)<a class="headerlink" href="#v0-13" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>New <code class="docutils literal notranslate"><span class="pre">--table</span></code> and <code class="docutils literal notranslate"><span class="pre">--fmt</span></code> options can be used to output query results in a variety of visual table formats, see <a class="reference internal" href="cli.html#cli-query-table"><span class="std std-ref">Table-formatted output</span></a></p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">hash_id=</span></code> argument can now be used for <a class="reference internal" href="python-api.html#python-api-hash"><span class="std std-ref">Setting an ID based on the hash of the row contents</span></a></p></li>
<li><p>Can now derive correct column types for numpy int, uint and float values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.last_id</span></code> has been renamed to <code class="docutils literal notranslate"><span class="pre">table.last_rowid</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.last_pk</span></code> now contains the last inserted primary key, if <code class="docutils literal notranslate"><span class="pre">pk=</span></code> was specified</p></li>
<li><p>Prettier indentation in the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> generated schemas</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/0.12 (2019-02-22)"></a><section id="v0-12">
<span id="id106"></span><h2>0.12 (2019-02-22)<a class="headerlink" href="#v0-12" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Added <code class="docutils literal notranslate"><span class="pre">db[table].rows</span></code> iterator - see <a class="reference internal" href="python-api.html#python-api-rows"><span class="std std-ref">Listing rows</span></a></p></li>
<li><p>Replaced <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">json</span></code> and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">csv</span></code> with a new default subcommand called <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">query</span></code> which defaults to JSON and takes formatting options <code class="docutils literal notranslate"><span class="pre">--nl</span></code>, <code class="docutils literal notranslate"><span class="pre">--csv</span></code> and <code class="docutils literal notranslate"><span class="pre">--no-headers</span></code> - see <a class="reference internal" href="cli.html#cli-query-json"><span class="std std-ref">Returning JSON</span></a> and <a class="reference internal" href="cli.html#cli-query-csv"><span class="std std-ref">Returning CSV or TSV</span></a></p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">rows</span> <span class="pre">data.db</span> <span class="pre">name-of-table</span></code> command, see <a class="reference internal" href="cli.html#cli-rows"><span class="std std-ref">Returning all rows in a table</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">table</span></code> command now takes options <code class="docutils literal notranslate"><span class="pre">--counts</span></code> and <code class="docutils literal notranslate"><span class="pre">--columns</span></code> plus the standard output format options, see <a class="reference internal" href="cli.html#cli-tables"><span class="std std-ref">Listing tables</span></a></p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/0.11 (2019-02-07)"></a><section id="v0-11">
<span id="id107"></span><h2>0.11 (2019-02-07)<a class="headerlink" href="#v0-11" title="Link to this heading">#</a></h2>
<p>New commands for enabling FTS against a table and columns:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sqlite-utils enable-fts db.db mytable col1 col2
</pre></div>
</div>
<p>See <a class="reference internal" href="cli.html#cli-fts"><span class="std std-ref">Configuring full-text search</span></a>.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/0.10 (2019-02-06)"></a><section id="v0-10">
<span id="id108"></span><h2>0.10 (2019-02-06)<a class="headerlink" href="#v0-10" title="Link to this heading">#</a></h2>
<p>Handle <code class="docutils literal notranslate"><span class="pre">datetime.date</span></code> and <code class="docutils literal notranslate"><span class="pre">datetime.time</span></code> values.</p>
<p>New option for efficiently inserting rows from a CSV:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sqlite-utils insert db.db foo - --csv
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/0.9 (2019-01-27)"></a><section id="v0-9">
<span id="id109"></span><h2>0.9 (2019-01-27)<a class="headerlink" href="#v0-9" title="Link to this heading">#</a></h2>
<p>Improved support for newline-delimited JSON.</p>
<p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span></code> has two new command-line options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--nl</span></code> means “expect newline-delimited JSON”. This is an extremely efficient way of loading in large amounts of data, especially if you pipe it into standard input.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--batch-size=1000</span></code> lets you increase the batch size (default is 100). A commit will be issued every X records. This also control how many initial records are considered when detecting the desired SQL table schema for the data.</p></li>
</ul>
<p>In the Python API, the <code class="docutils literal notranslate"><span class="pre">table.insert_all(...)</span></code> method can now accept a generator as well as a list of objects. This will be efficiently used to populate the table no matter how many records are produced by the generator.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Database()</span></code> constructor can now accept a <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code> object in addition to a string or an existing SQLite connection object.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/0.8 (2019-01-25)"></a><section id="v0-8">
<span id="id110"></span><h2>0.8 (2019-01-25)<a class="headerlink" href="#v0-8" title="Link to this heading">#</a></h2>
<p>Two new commands: <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">csv</span></code> and <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">json</span></code></p>
<p>These commands execute a SQL query and return the results as CSV or JSON. See <a class="reference internal" href="cli.html#cli-query-csv"><span class="std std-ref">Returning CSV or TSV</span></a> and <a class="reference internal" href="cli.html#cli-query-json"><span class="std std-ref">Returning JSON</span></a> for more details.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sqlite-utils json --help
Usage: sqlite-utils json [OPTIONS] PATH SQL

  Execute SQL query and return the results as JSON

Options:
  --nl      Output newline-delimited JSON
  --arrays  Output rows as arrays instead of objects
  --help    Show this message and exit.

$ sqlite-utils csv --help
Usage: sqlite-utils csv [OPTIONS] PATH SQL

  Execute SQL query and return the results as CSV

Options:
  --no-headers  Exclude headers from CSV output
  --help        Show this message and exit.
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/0.7 (2019-01-24)"></a><section id="v0-7">
<span id="id111"></span><h2>0.7 (2019-01-24)<a class="headerlink" href="#v0-7" title="Link to this heading">#</a></h2>
<p>This release implements the <code class="docutils literal notranslate"><span class="pre">sqlite-utils</span></code> command-line tool with a number of useful subcommands.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">tables</span> <span class="pre">demo.db</span></code> lists the tables in the database</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">tables</span> <span class="pre">demo.db</span> <span class="pre">--fts4</span></code> shows just the FTS4 tables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">tables</span> <span class="pre">demo.db</span> <span class="pre">--fts5</span></code> shows just the FTS5 tables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">vacuum</span> <span class="pre">demo.db</span></code> runs VACUUM against the database</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">optimize</span> <span class="pre">demo.db</span></code> runs OPTIMIZE against all FTS tables, then VACUUM</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">optimize</span> <span class="pre">demo.db</span> <span class="pre">--no-vacuum</span></code> runs OPTIMIZE but skips VACUUM</p></li>
</ul>
<p>The two most useful subcommands are <code class="docutils literal notranslate"><span class="pre">upsert</span></code> and <code class="docutils literal notranslate"><span class="pre">insert</span></code>, which allow you to ingest JSON files with one or more records in them, creating the corresponding table with the correct columns if it does not already exist. See <a class="reference internal" href="cli.html#cli-inserting-data"><span class="std std-ref">Inserting JSON data</span></a> for more details.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">insert</span> <span class="pre">demo.db</span> <span class="pre">dogs</span> <span class="pre">dogs.json</span> <span class="pre">--pk=id</span></code> inserts new records from <code class="docutils literal notranslate"><span class="pre">dogs.json</span></code> into the <code class="docutils literal notranslate"><span class="pre">dogs</span></code> table</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sqlite-utils</span> <span class="pre">upsert</span> <span class="pre">demo.db</span> <span class="pre">dogs</span> <span class="pre">dogs.json</span> <span class="pre">--pk=id</span></code> upserts records, replacing any records with duplicate primary keys</p></li>
</ul>
<p>One backwards incompatible change: the <code class="docutils literal notranslate"><span class="pre">db["table"].table_names</span></code> property is now a method:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">db["table"].table_names()</span></code> returns a list of table names</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db["table"].table_names(fts4=True)</span></code> returns a list of just the FTS4 tables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db["table"].table_names(fts5=True)</span></code> returns a list of just the FTS5 tables</p></li>
</ul>
<p>A few other changes:</p>
<ul class="simple">
<li><p>Plenty of updated documentation, including full coverage of the new command-line tool</p></li>
<li><p>Allow column names to be reserved words (use correct SQL escaping)</p></li>
<li><p>Added automatic column support for bytes and datetime.datetime</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/0.6 (2018-08-12)"></a><section id="v0-6">
<span id="id112"></span><h2>0.6 (2018-08-12)<a class="headerlink" href="#v0-6" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.enable_fts()</span></code> now takes optional argument <code class="docutils literal notranslate"><span class="pre">fts_version</span></code>, defaults to <code class="docutils literal notranslate"><span class="pre">FTS5</span></code>. Use <code class="docutils literal notranslate"><span class="pre">FTS4</span></code> if the version of SQLite bundled with your Python does not support FTS5</p></li>
<li><p>New optional <code class="docutils literal notranslate"><span class="pre">column_order=</span></code> argument to <code class="docutils literal notranslate"><span class="pre">.insert()</span></code> and friends for providing a partial or full desired order of the columns when a database table is created</p></li>
<li><p><a class="reference internal" href="python-api.html#python-api"><span class="std std-ref">New documentation</span></a> for <code class="docutils literal notranslate"><span class="pre">.insert_all()</span></code> and <code class="docutils literal notranslate"><span class="pre">.upsert()</span></code> and <code class="docutils literal notranslate"><span class="pre">.upsert_all()</span></code></p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/0.5 (2018-08-05)"></a><section id="v0-5">
<span id="id113"></span><h2>0.5 (2018-08-05)<a class="headerlink" href="#v0-5" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">db.tables</span></code> and <code class="docutils literal notranslate"><span class="pre">db.table_names</span></code> introspection properties</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db.indexes</span></code> property for introspecting indexes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table.create_index(columns,</span> <span class="pre">index_name)</span></code> method</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db.create_view(name,</span> <span class="pre">sql)</span></code> method</p></li>
<li><p>Table methods can now be chained, plus added <code class="docutils literal notranslate"><span class="pre">table.last_id</span></code> for accessing the last inserted row ID</p></li>
</ul>
</section>
<section id="id114">
<h2>0.4 (2018-07-31)<a class="headerlink" href="#id114" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">enable_fts()</span></code>, <code class="docutils literal notranslate"><span class="pre">populate_fts()</span></code> and <code class="docutils literal notranslate"><span class="pre">search()</span></code> table methods</p></li>
</ul>
</section>
</section>
</article>
</div>
<footer>
<div class="related-pages">
<a class="prev-page" href="contributing.html">
<svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
<div class="page-info">
<div class="context">
<span>Previous</span>
</div>
<div class="title">Contributing</div>
</div>
</a>
</div>
<div class="bottom-of-page">
<div class="left-details">
<div class="copyright">
                Copyright © 2018-2022, Simon Willison
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
</div>
<div class="right-details">
</div>
</div>
</footer>
</div>
<aside class="toc-drawer">
<div class="toc-sticky toc-scroll">
<div class="toc-title-container">
<span class="toc-title">
            On this page
          </span>
</div>
<div class="toc-tree-container">
<div class="toc-tree">
<ul>
<li><a class="reference internal" href="#">Changelog</a><ul>
<li><a class="reference internal" href="#v3-33">3.33 (2023-06-25)</a></li>
<li><a class="reference internal" href="#v3-32-1">3.32.1 (2023-05-21)</a></li>
<li><a class="reference internal" href="#v3-32">3.32 (2023-05-21)</a></li>
<li><a class="reference internal" href="#v3-31">3.31 (2023-05-08)</a></li>
<li><a class="reference internal" href="#v3-30">3.30 (2022-10-25)</a></li>
<li><a class="reference internal" href="#v3-29">3.29 (2022-08-27)</a></li>
<li><a class="reference internal" href="#v3-28">3.28 (2022-07-15)</a></li>
<li><a class="reference internal" href="#v3-27">3.27 (2022-06-14)</a></li>
<li><a class="reference internal" href="#v3-26-1">3.26.1 (2022-05-02)</a></li>
<li><a class="reference internal" href="#v3-26">3.26 (2022-04-13)</a></li>
<li><a class="reference internal" href="#v3-25-1">3.25.1 (2022-03-11)</a></li>
<li><a class="reference internal" href="#v3-25">3.25 (2022-03-01)</a></li>
<li><a class="reference internal" href="#v3-24">3.24 (2022-02-15)</a></li>
<li><a class="reference internal" href="#v3-23">3.23 (2022-02-03)</a></li>
<li><a class="reference internal" href="#v3-22-1">3.22.1 (2022-01-25)</a></li>
<li><a class="reference internal" href="#v3-22">3.22 (2022-01-11)</a></li>
<li><a class="reference internal" href="#v3-21">3.21 (2022-01-10)</a></li>
<li><a class="reference internal" href="#v3-20">3.20 (2022-01-05)</a></li>
<li><a class="reference internal" href="#v3-19">3.19 (2021-11-20)</a></li>
<li><a class="reference internal" href="#v3-18">3.18 (2021-11-14)</a></li>
<li><a class="reference internal" href="#v3-17-1">3.17.1 (2021-09-22)</a></li>
<li><a class="reference internal" href="#v3-17">3.17 (2021-08-24)</a></li>
<li><a class="reference internal" href="#v3-16">3.16 (2021-08-18)</a></li>
<li><a class="reference internal" href="#v3-15-1">3.15.1 (2021-08-10)</a></li>
<li><a class="reference internal" href="#v3-15">3.15 (2021-08-09)</a></li>
<li><a class="reference internal" href="#v3-14">3.14 (2021-08-02)</a></li>
<li><a class="reference internal" href="#v3-13">3.13 (2021-07-24)</a></li>
<li><a class="reference internal" href="#v3-12">3.12 (2021-06-25)</a></li>
<li><a class="reference internal" href="#v3-11">3.11 (2021-06-20)</a></li>
<li><a class="reference internal" href="#v3-10">3.10 (2021-06-19)</a><ul>
<li><a class="reference internal" href="#sqlite-utils-memory">sqlite-utils memory</a></li>
<li><a class="reference internal" href="#sqlite-utils-insert-detect-types">sqlite-utils insert --detect-types</a></li>
<li><a class="reference internal" href="#other-changes">Other changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#v3-9-1">3.9.1 (2021-06-12)</a></li>
<li><a class="reference internal" href="#v3-9">3.9 (2021-06-11)</a></li>
<li><a class="reference internal" href="#v3-8">3.8 (2021-06-02)</a></li>
<li><a class="reference internal" href="#v3-7">3.7 (2021-05-28)</a></li>
<li><a class="reference internal" href="#v3-6">3.6 (2021-02-18)</a></li>
<li><a class="reference internal" href="#v3-5">3.5 (2021-02-14)</a></li>
<li><a class="reference internal" href="#v3-4-1">3.4.1 (2021-02-05)</a></li>
<li><a class="reference internal" href="#v3-4">3.4 (2021-02-05)</a></li>
<li><a class="reference internal" href="#v3-3">3.3 (2021-01-17)</a></li>
<li><a class="reference internal" href="#v3-2-1">3.2.1 (2021-01-12)</a></li>
<li><a class="reference internal" href="#v3-2">3.2 (2021-01-03)</a></li>
<li><a class="reference internal" href="#v3-1-1">3.1.1 (2021-01-01)</a></li>
<li><a class="reference internal" href="#v3-1">3.1 (2020-12-12)</a></li>
<li><a class="reference internal" href="#v3-0">3.0 (2020-11-08)</a></li>
<li><a class="reference internal" href="#v2-23">2.23 (2020-10-28)</a></li>
<li><a class="reference internal" href="#v2-22">2.22 (2020-10-16)</a></li>
<li><a class="reference internal" href="#v2-21">2.21 (2020-09-24)</a></li>
<li><a class="reference internal" href="#v2-20">2.20 (2020-09-22)</a><ul>
<li><a class="reference internal" href="#transform">Transform</a></li>
<li><a class="reference internal" href="#extract">Extract</a></li>
<li><a class="reference internal" href="#id50">Other changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#v2-19">2.19 (2020-09-20)</a></li>
<li><a class="reference internal" href="#v2-18">2.18 (2020-09-08)</a></li>
<li><a class="reference internal" href="#v2-17">2.17 (2020-09-07)</a></li>
<li><a class="reference internal" href="#v2-16-1">2.16.1 (2020-08-28)</a></li>
<li><a class="reference internal" href="#v2-16">2.16 (2020-08-21)</a></li>
<li><a class="reference internal" href="#v2-15-1">2.15.1 (2020-08-12)</a></li>
<li><a class="reference internal" href="#v2-15">2.15 (2020-08-10)</a></li>
<li><a class="reference internal" href="#v2-14-1">2.14.1 (2020-08-05)</a></li>
<li><a class="reference internal" href="#v2-14">2.14 (2020-08-01)</a></li>
<li><a class="reference internal" href="#v2-13">2.13 (2020-07-29)</a></li>
<li><a class="reference internal" href="#v2-12">2.12 (2020-07-27)</a></li>
<li><a class="reference internal" href="#v2-11">2.11 (2020-07-08)</a></li>
<li><a class="reference internal" href="#v2-10-1">2.10.1 (2020-06-23)</a></li>
<li><a class="reference internal" href="#v2-10">2.10 (2020-06-12)</a></li>
<li><a class="reference internal" href="#v2-9-1">2.9.1 (2020-05-11)</a></li>
<li><a class="reference internal" href="#v2-9">2.9 (2020-05-10)</a></li>
<li><a class="reference internal" href="#v2-8">2.8 (2020-05-03)</a></li>
<li><a class="reference internal" href="#v2-7-2">2.7.2 (2020-05-02)</a></li>
<li><a class="reference internal" href="#v2-7-1">2.7.1 (2020-05-01)</a></li>
<li><a class="reference internal" href="#v2-7">2.7 (2020-04-17)</a></li>
<li><a class="reference internal" href="#v2-6">2.6 (2020-04-15)</a></li>
<li><a class="reference internal" href="#v2-5">2.5 (2020-04-12)</a></li>
<li><a class="reference internal" href="#v2-4-4">2.4.4 (2020-03-23)</a></li>
<li><a class="reference internal" href="#v2-4-3">2.4.3 (2020-03-23)</a></li>
<li><a class="reference internal" href="#v2-4-2">2.4.2 (2020-03-14)</a></li>
<li><a class="reference internal" href="#v2-4-1">2.4.1 (2020-03-01)</a></li>
<li><a class="reference internal" href="#v2-4">2.4 (2020-02-26)</a></li>
<li><a class="reference internal" href="#v2-3-1">2.3.1 (2020-02-10)</a></li>
<li><a class="reference internal" href="#v2-3">2.3 (2020-02-08)</a></li>
<li><a class="reference internal" href="#v2-2-1">2.2.1 (2020-02-06)</a></li>
<li><a class="reference internal" href="#v2-2">2.2 (2020-02-01)</a></li>
<li><a class="reference internal" href="#v2-1">2.1 (2020-01-30)</a></li>
<li><a class="reference internal" href="#v2-0-1">2.0.1 (2020-01-05)</a></li>
<li><a class="reference internal" href="#v2">2.0 (2019-12-29)</a></li>
<li><a class="reference internal" href="#v1-12-1">1.12.1 (2019-11-06)</a></li>
<li><a class="reference internal" href="#v1-12">1.12 (2019-11-04)</a></li>
<li><a class="reference internal" href="#v1-11">1.11 (2019-09-02)</a></li>
<li><a class="reference internal" href="#v1-10">1.10 (2019-08-23)</a></li>
<li><a class="reference internal" href="#v1-9">1.9 (2019-08-04)</a></li>
<li><a class="reference internal" href="#v1-8">1.8 (2019-07-28)</a></li>
<li><a class="reference internal" href="#v1-7-1">1.7.1 (2019-07-28)</a></li>
<li><a class="reference internal" href="#v1-7">1.7 (2019-07-24)</a></li>
<li><a class="reference internal" href="#v1-6">1.6 (2019-07-18)</a></li>
<li><a class="reference internal" href="#v1-5">1.5 (2019-07-14)</a></li>
<li><a class="reference internal" href="#v1-4-1">1.4.1 (2019-07-14)</a></li>
<li><a class="reference internal" href="#v1-4">1.4 (2019-06-30)</a></li>
<li><a class="reference internal" href="#v1-3">1.3 (2019-06-28)</a></li>
<li><a class="reference internal" href="#v1-2-2">1.2.2 (2019-06-25)</a></li>
<li><a class="reference internal" href="#v1-2-1">1.2.1 (2019-06-20)</a></li>
<li><a class="reference internal" href="#v1-2">1.2 (2019-06-12)</a></li>
<li><a class="reference internal" href="#v1-1">1.1 (2019-05-28)</a></li>
<li><a class="reference internal" href="#v1-0-1">1.0.1 (2019-05-27)</a></li>
<li><a class="reference internal" href="#v1-0">1.0 (2019-05-24)</a></li>
<li><a class="reference internal" href="#v0-14">0.14 (2019-02-24)</a></li>
<li><a class="reference internal" href="#v0-13">0.13 (2019-02-23)</a></li>
<li><a class="reference internal" href="#v0-12">0.12 (2019-02-22)</a></li>
<li><a class="reference internal" href="#v0-11">0.11 (2019-02-07)</a></li>
<li><a class="reference internal" href="#v0-10">0.10 (2019-02-06)</a></li>
<li><a class="reference internal" href="#v0-9">0.9 (2019-01-27)</a></li>
<li><a class="reference internal" href="#v0-8">0.8 (2019-01-25)</a></li>
<li><a class="reference internal" href="#v0-7">0.7 (2019-01-24)</a></li>
<li><a class="reference internal" href="#v0-6">0.6 (2018-08-12)</a></li>
<li><a class="reference internal" href="#v0-5">0.5 (2018-08-05)</a></li>
<li><a class="reference internal" href="#id114">0.4 (2018-07-31)</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</aside>
</div>
</div>
<script src="_static/documentation_options.js?v=6539fd82"></script>
<script src="_static/doctools.js?v=888ff710"></script>
<script src="_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="_static/scripts/furo.js?v=32e29ea5"></script>
<script src="_static/clipboard.min.js?v=a7894cd8"></script>
<script src="_static/copybutton.js?v=f281be69"></script>
<script src="_static/js/custom.js?v=6323a214"></script>
<style type="text/css">
.highlight-output .highlight {
  border-left: 9px solid #30c94f;
}
</style>
<script>
document.addEventListener("DOMContentLoaded", function() {
  // Show banner linking to /stable/ if this is a /latest/ page
  if (!/\/latest\//.test(location.pathname)) {
    return;
  }
  var stableUrl = location.pathname.replace("/latest/", "/stable/");
  // Check it's not a 404
  fetch(stableUrl, { method: "HEAD" }).then((response) => {
    if (response.status === 200) {
      var warning = document.createElement("div");
      warning.className = "admonition warning";
      warning.innerHTML = `
        <p class="first admonition-title">Note</p>
        <p class="last">
          This documentation covers the <strong>development version</strong> of Datasette.
        </p>
        <p>
          See <a href="${stableUrl}">this page</a> for the current stable release.
        </p>
      `;
      var mainArticle = document.querySelector("article[role=main]");
      mainArticle.insertBefore(warning, mainArticle.firstChild);
    }
  });
});
</script>
</body>
</html>